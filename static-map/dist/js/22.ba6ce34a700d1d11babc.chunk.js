(self.webpackChunkstatic_map=self.webpackChunkstatic_map||[]).push([[22],{38272:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var s=o(24852),r=o(43033);let i;const n=e=>{const{map:t,onBoxEnd:o,status:n}=e;return(0,s.useEffect)((()=>{"start"===n?(i=new r.Z({condition:function(e){return e.originalEvent.altKey}}),t.addInteraction(i)):"end"===n&&t.removeInteraction(i)}),[n]),(0,s.useEffect)((()=>{i&&i.on("boxend",(e=>{o({boxExtent:i.getGeometry().getExtent(),modifiers:{ctrl:e.mapBrowserEvent.pointerEvent.ctrlKey,metaKey:e.mapBrowserEvent.pointerEvent.metaKey}})}))}),[n]),null}},81636:(e,t,o)=>{"use strict";o.d(t,{Z:()=>ke});var s=o(24852),r=o.n(s),i=o(57043),n=o.n(i),a=o(91175),l=o.n(a),p=o(13311),h=o.n(p),c=o(12571),u=o.n(c),d=o(57557),m=o.n(d),g=o(1469),y=o.n(g),f=o(10928),v=o.n(f),_=o(63105),w=o.n(_),b=o(14293),x=o.n(b),C=o(84596),E=o.n(C),L=o(45697),P=o.n(L),S=o(27418),T=o.n(S),O=o(55877),F=o.n(O),G=o(9669),M=o.n(G),I=o(68105),k=o(10312),Z=o(79055),j=o(80543),D=o(89565),N=o(80034),R=o(69141),V=o(23068),A=o(97016),z=o(29902),B=o(72445),H=o(52329),U=o(40353),W=o(52043),q=o(44538),K=o(25642),X=o(13987),Y=o(69669),$=o(98090),J=o(31219),Q=o(98185),ee=o(20767),te=o(15565),oe=o(9371),se=o(78426),re=o(36403),ie=o(18369),ne=o(58493),ae=o(13002),le=o(9520),pe=o(64011),he=o(79682),ce=o(38024),ue=o(73604),de=function(e){function t(t,o,s){e.call(this,t),this.features=o,this.coordinate=s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(le.ZP);const me=function(e){function t(t){var o,s=t||{};if(e.call(this,s),this.lastCoordinate_=null,this.features_=void 0!==s.features?s.features:null,s.layers)if("function"==typeof s.layers)o=s.layers;else{var r=s.layers;o=function(e){return(0,he.q9)(r,e)}}else o=pe.uX;this.layerFilter_=o,this.hitTolerance_=s.hitTolerance?s.hitTolerance:0,this.lastFeature_=null,(0,ae.oL)(this,(0,ne.v_)(ue.Z.ACTIVE),this.handleActiveChanged_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.handleDownEvent=function(e){if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);var t=this.features_||new se.Z([this.lastFeature_]);return this.dispatchEvent(new de("translatestart",t,e.coordinate)),!0}return!1},t.prototype.handleUpEvent=function(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);var t=this.features_||new se.Z([this.lastFeature_]);return this.dispatchEvent(new de("translateend",t,e.coordinate)),!0}return!1},t.prototype.handleDragEvent=function(e){if(this.lastCoordinate_){var t=e.coordinate,o=t[0]-this.lastCoordinate_[0],s=t[1]-this.lastCoordinate_[1],r=this.features_||new se.Z([this.lastFeature_]);r.forEach((function(e){var t=e.getGeometry();t.translate(o,s),e.setGeometry(t)})),this.lastCoordinate_=t,this.dispatchEvent(new de("translating",r,t))}},t.prototype.handleMoveEvent=function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")},t.prototype.featuresAtPixel_=function(e,t){return t.forEachFeatureAtPixel(e,function(e){if(!this.features_||(0,he.q9)(this.features_.getArray(),e))return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var o=this.getMap();e.prototype.setMap.call(this,t),this.updateState_(o)},t.prototype.handleActiveChanged_=function(){this.updateState_(null)},t.prototype.updateState_=function(e){var t=this.getMap(),o=this.getActive();t&&o||(t=t||e)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")},t}(ce.Z);var ge=o(49179),ye=o(19629),fe=o(30006),ve=o(90728),_e=o(73381),we=o(21915),be=o(28795),xe=o(25753),Ce=o(73101),Ee="modifyend",Le=function(e){function t(t,o,s){e.call(this,t),this.features=o,this.mapBrowserEvent=s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(le.ZP);function Pe(e,t){return e.index-t.index}function Se(e,t){var o=t.geometry;if(o.getType()===be.Z.CIRCLE){var s=o;if(1===t.index){var r=(0,ve.bI)(s.getCenter(),e),i=Math.sqrt(r)-s.getRadius();return i*i}}return(0,ve.Bs)(e,t.segment)}function Te(e,t){var o=t.geometry;return o.getType()===be.Z.CIRCLE&&1===t.index?o.getClosestPoint(e):(0,ve.oL)(e,t.segment)}const Oe=function(e){function t(t){var o,s;if(e.call(this,t),this.condition_=t.condition?t.condition:re.Xp,this.defaultDeleteCondition_=function(e){return(0,re.Ko)(e)&&(0,re.Kf)(e)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:re.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new Ce.Z,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new z.Z({source:new A.Z({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(o=(0,J.createEditingStyle)(),function(e,t){return o[be.Z.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,t.source?(this.source_=t.source,s=new se.Z(this.source_.getFeatures()),(0,ae.oL)(this.source_,xe.Z.ADDFEATURE,this.handleSourceAdd_,this),(0,ae.oL)(this.source_,xe.Z.REMOVEFEATURE,this.handleSourceRemove_,this)):s=t.features,!s)throw new Error("The modify interaction requires features or a source");this.features_=s,this.features_.forEach(this.addFeature_.bind(this)),(0,ae.oL)(this.features_,ye.Z.ADD,this.handleFeatureAdd_,this),(0,ae.oL)(this.features_,ye.Z.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeature_=function(e){var t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);var o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,o),(0,ae.oL)(e,_e.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new Le("modifystart",this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,ae.Ev)(e,_e.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,o=[];t.forEach((function(t){e===t.feature&&o.push(t)}));for(var s=o.length-1;s>=0;--s)t.remove(o[s])},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var o=t.getCoordinates(),s={feature:e,geometry:t,segment:[o,o]};this.rBush_.insert(t.getExtent(),s)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var o=t.getCoordinates(),s=0,r=o.length;s<r;++s){var i=o[s],n={feature:e,geometry:t,depth:[s],index:s,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var o=t.getCoordinates(),s=0,r=o.length-1;s<r;++s){var i=o.slice(s,s+2),n={feature:e,geometry:t,index:s,segment:i};this.rBush_.insert((0,we.hI)(i),n)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var o=t.getCoordinates(),s=0,r=o.length;s<r;++s)for(var i=o[s],n=0,a=i.length-1;n<a;++n){var l=i.slice(n,n+2),p={feature:e,geometry:t,depth:[s],index:n,segment:l};this.rBush_.insert((0,we.hI)(l),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var o=t.getCoordinates(),s=0,r=o.length;s<r;++s)for(var i=o[s],n=0,a=i.length-1;n<a;++n){var l=i.slice(n,n+2),p={feature:e,geometry:t,depth:[s],index:n,segment:l};this.rBush_.insert((0,we.hI)(l),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var o=t.getCoordinates(),s=0,r=o.length;s<r;++s)for(var i=o[s],n=0,a=i.length;n<a;++n)for(var l=i[n],p=0,h=l.length-1;p<h;++p){var c=l.slice(p,p+2),u={feature:e,geometry:t,depth:[n,s],index:p,segment:c};this.rBush_.insert((0,we.hI)(c),u)}},t.prototype.writeCircleGeometry_=function(e,t){var o=t.getCenter(),s={feature:e,geometry:t,index:0,segment:[o,o]},r={feature:e,geometry:t,index:1,segment:[o,o]},i=[s,r];s.featureSegments=r.featureSegments=i,this.rBush_.insert((0,we.HK)(o),s),this.rBush_.insert(t.getExtent(),r)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var o=t.getGeometriesArray(),s=0;s<o.length;++s)this.SEGMENT_WRITERS_[o[s].getType()].call(this,e,o[s])},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(e):(t=new V.Z(new W.Z(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=fe.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(o=!(t.type!=fe.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==fe.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!o);var o},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,o=0,s=this.dragSegments_.length;o<s;++o){for(var r=this.dragSegments_[o],i=r[0],n=i.depth,a=i.geometry,l=void 0,p=i.segment,h=r[1];t.length<a.getStride();)t.push(p[h][t.length]);switch(a.getType()){case be.Z.POINT:l=t,p[0]=p[1]=t;break;case be.Z.MULTI_POINT:(l=a.getCoordinates())[i.index]=t,p[0]=p[1]=t;break;case be.Z.LINE_STRING:(l=a.getCoordinates())[i.index+h]=t,p[h]=t;break;case be.Z.MULTI_LINE_STRING:case be.Z.POLYGON:(l=a.getCoordinates())[n[0]][i.index+h]=t,p[h]=t;break;case be.Z.MULTI_POLYGON:(l=a.getCoordinates())[n[1]][n[0]][i.index+h]=t,p[h]=t;break;case be.Z.CIRCLE:p[0]=p[1]=t,0===i.index?(this.changingFeature_=!0,a.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius((0,ve.TE)(a.getCenter(),t)),this.changingFeature_=!1)}l&&this.setGeometryCoordinates_(a,l)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);var t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;var o=this.vertexFeature_;if(o){var s=[],r=o.getGeometry().getCoordinates(),i=(0,we.hI)([r]),n=this.rBush_.getInExtent(i),a={};n.sort(Pe);for(var l=0,p=n.length;l<p;++l){var h=n[l],c=h.segment,u=(0,ge.sq)(h.feature),d=h.depth;if(d&&(u+="-"+d.join("-")),a[u]||(a[u]=new Array(2)),h.geometry.getType()===be.Z.CIRCLE&&1===h.index){var m=Te(t,h);(0,ve.fS)(m,r)&&!a[u][0]&&(this.dragSegments_.push([h,0]),a[u][0]=h)}else if((0,ve.fS)(c[0],r)&&!a[u][0])this.dragSegments_.push([h,0]),a[u][0]=h;else if((0,ve.fS)(c[1],r)&&!a[u][1]){if((h.geometry.getType()===be.Z.LINE_STRING||h.geometry.getType()===be.Z.MULTI_LINE_STRING)&&a[u][0]&&0===a[u][0].index)continue;this.dragSegments_.push([h,1]),a[u][1]=h}else this.insertVertexCondition_(e)&&(0,ge.sq)(c)in this.vertexSegments_&&!a[u][0]&&!a[u][1]&&s.push([h,r])}s.length&&this.willModifyFeatures_(e);for(var g=s.length-1;g>=0;--g)this.insertVertex_.apply(this,s[g])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var o=this.dragSegments_[t][0],s=o.geometry;if(s.getType()===be.Z.CIRCLE){var r=s.getCenter(),i=o.featureSegments[0],n=o.featureSegments[1];i.segment[0]=i.segment[1]=r,n.segment[0]=n.segment[1]=r,this.rBush_.update((0,we.HK)(r),i),this.rBush_.update(s.getExtent(),n)}else this.rBush_.update((0,we.hI)(o.segment),o)}return this.modified_&&(this.dispatchEvent(new Le(Ee,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},t.prototype.handlePointerAtPixel_=function(e,t){var o=t.getCoordinateFromPixel(e),s=(0,we.f3)((0,we.HK)(o),t.getView().getResolution()*this.pixelTolerance_),r=this.rBush_.getInExtent(s);if(r.length>0){r.sort((function(e,t){return Se(o,e)-Se(o,t)}));var i=r[0],n=i.segment,a=Te(o,i),l=t.getPixelFromCoordinate(a),p=(0,ve.TE)(e,l);if(p<=this.pixelTolerance_){var h={};if(i.geometry.getType()===be.Z.CIRCLE&&1===i.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a);else{var c=t.getPixelFromCoordinate(n[0]),u=t.getPixelFromCoordinate(n[1]),d=(0,ve.bI)(l,c),m=(0,ve.bI)(l,u);p=Math.sqrt(Math.min(d,m)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(a=d>m?n[1]:n[0]),this.createOrUpdateVertexFeature_(a);for(var g=1,y=r.length;g<y;++g){var f=r[g].segment;if(!((0,ve.fS)(n[0],f[0])&&(0,ve.fS)(n[1],f[1])||(0,ve.fS)(n[0],f[1])&&(0,ve.fS)(n[1],f[0])))break;h[(0,ge.sq)(f)]=!0}}return h[(0,ge.sq)(n)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var o,s=e.segment,r=e.feature,i=e.geometry,n=e.depth,a=e.index;t.length<i.getStride();)t.push(0);switch(i.getType()){case be.Z.MULTI_LINE_STRING:case be.Z.POLYGON:(o=i.getCoordinates())[n[0]].splice(a+1,0,t);break;case be.Z.MULTI_POLYGON:(o=i.getCoordinates())[n[1]][n[0]].splice(a+1,0,t);break;case be.Z.LINE_STRING:(o=i.getCoordinates()).splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(i,o);var l=this.rBush_;l.remove(e),this.updateSegmentIndices_(i,a,n,1);var p={segment:[s[0],t],feature:r,geometry:i,depth:n,index:a};l.insert((0,we.hI)(p.segment),p),this.dragSegments_.push([p,1]);var h={segment:[t,s[1]],feature:r,geometry:i,depth:n,index:a+1};l.insert((0,we.hI)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=fe.Z.POINTERDRAG){var e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new Le(Ee,this.features_,e)),this.modified_=!1,!0}return!1},t.prototype.removeVertex_=function(){var e,t,o,s,r,i,n,a,l,p,h,c=this.dragSegments_,u={},d=!1;for(r=c.length-1;r>=0;--r)p=(o=c[r])[0],h=(0,ge.sq)(p.feature),p.depth&&(h+="-"+p.depth.join("-")),h in u||(u[h]={}),0===o[1]?(u[h].right=p,u[h].index=p.index):1==o[1]&&(u[h].left=p,u[h].index=p.index+1);for(h in u){switch(l=u[h].right,n=u[h].left,(a=(i=u[h].index)-1)<0&&(a=0),e=t=(s=(p=void 0!==n?n:l).geometry).getCoordinates(),d=!1,s.getType()){case be.Z.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(i,1),d=!0);break;case be.Z.LINE_STRING:t.length>2&&(t.splice(i,1),d=!0);break;case be.Z.MULTI_POLYGON:e=e[p.depth[1]];case be.Z.POLYGON:(e=e[p.depth[0]]).length>4&&(i==e.length-1&&(i=0),e.splice(i,1),d=!0,0===i&&(e.pop(),e.push(e[0]),a=e.length-1))}if(d){this.setGeometryCoordinates_(s,t);var m=[];if(void 0!==n&&(this.rBush_.remove(n),m.push(n.segment[0])),void 0!==l&&(this.rBush_.remove(l),m.push(l.segment[1])),void 0!==n&&void 0!==l){var g={depth:p.depth,feature:p.feature,geometry:p.geometry,index:a,segment:m};this.rBush_.insert((0,we.hI)(g.segment),g)}this.updateSegmentIndices_(s,i,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return d},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,o,s){this.rBush_.forEachInExtent(e.getExtent(),(function(r){r.geometry===e&&(void 0===o||void 0===r.depth||(0,he.fS)(r.depth,o))&&r.index>t&&(r.index+=s)}))},t}(ce.Z);var Fe=o(51273),Ge=o(56834);function Me(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const Ie=new R.Z;class ke extends r().Component{constructor(){var e;super(...arguments),e=this,Me(this,"getNewFeature",((e,t,o,s)=>new V.Z({geometry:this.createOLGeometry({type:e,coordinates:t,radius:o,center:s})}))),Me(this,"getMapCrs",(()=>this.props.map.getView().getProjection().getCode())),Me(this,"updateFeatureStyles",(e=>{e&&e.length>0&&e.forEach((e=>{if(e.style){let t=this.toOlFeature(e);t&&t.setStyle(e.style?(0,N.C2)(e):this.toOlStyle(e.style,e.selected))}}))})),Me(this,"updateOnlyFeatureStyles",(e=>{this.drawLayer&&this.drawLayer.getSource().getFeatures().forEach((t=>{let o=l()(e.features).features||e.features,s=h()(o,(e=>e.properties.id===t.getProperties().id));if(s){let e=(0,Z.createStylesAsync)(E()(s.style));M().all(e).then((e=>{t.setStyle((()=>(0,N.Cw)({...s,style:e})))}))}}))})),Me(this,"addLayer",((e,t)=>{let o=null;const s=this.convertGeometryTypeToStyleType(e.drawMethod);o=t=>{let o=l()(e.features)&&h()(l()(e.features).features,(e=>e.properties.id===t.getProperties().id))||null;if(o){let e=(0,Z.createStylesAsync)(E()(o.style));return M().all(e).then((e=>{t.setStyle((()=>(0,N.Cw)({...o,style:e})))})),null}return(0,N.Cw)({style:N.jF[s]})},this.geojson=new R.Z,this.drawSource=new A.Z,this.drawLayer=new z.Z({source:this.drawSource,zIndex:1e8,style:o}),this.props.map.addLayer(this.drawLayer),t&&this.addInteractions(e);let r=l()(e.features);if(r&&r.features&&r.features.length){const t=r.features.filter((t=>!t.properties.isCircle||t.properties.isCircle&&!t.properties.canEdit||!e.options.drawEnabled));return this.addFeatures(T()({},e,{features:[{...r,features:t}]}))}return this.addFeatures(e)})),Me(this,"addFeatures",(e=>{let{features:t,drawMethod:o,options:s}=e;const r=this.getMapCrs();let i;if(t.forEach((e=>{if("FeatureCollection"===e.type){let t=(new R.Z).readFeatures(e);s.geodesic||(t=t.map((e=>(0,j.a)(e,r)))),this.drawSource=new A.Z({features:t}),this.drawLayer.setSource(this.drawSource)}else{let n=null,a=e;var t;if(a.geometry&&"GeometryCollection"!==a.geometry.type&&(a=(0,k.reprojectGeoJson)(a,a.featureProjection,r).geometry),"GeometryCollection"!==a.type)"Circle"===o&&a&&(a.properties&&a.properties.center||a.center)?(n=a.properties&&a.properties.center?(0,k.reproject)(a.properties.center,"EPSG:4326",r):a.center,n=[n.x,n.y],i=new V.Z({geometry:this.createOLGeometry({type:"Circle",center:n,projection:"EPSG:3857",radius:a.properties&&a.properties.radius||a.radius,options:s})})):i=new V.Z({geometry:this.createOLGeometry(a.geometry?a.geometry:{...a,radius:null===(t=a.properties)||void 0===t?void 0:t.radius,center:n})}),i.setProperties(e.properties),this.drawSource.addFeature(i)}})),0===t.length&&(s.editEnabled||s.drawEnabled))s.transformToFeatureCollection?(this.drawSource=new A.Z({features:(new R.Z).readFeatures({type:"FeatureCollection",features:[]})}),this.drawLayer.setSource(this.drawSource)):(i=new V.Z({geometry:this.createOLGeometry({type:o,coordinates:null})}),this.drawSource.addFeature(i));else{if(t[0]&&"GeometryCollection"===t[0].type){this.drawSource=new A.Z({features:(new R.Z).readFeatures(t[0])});let e=this.replacePolygonsWithCircles(this.drawSource.getFeatures()[0]);this.drawSource.getFeatures()[0].getGeometry().setGeometries(e),this.drawLayer.setSource(this.drawSource)}t[0]&&t[0].geometry&&"GeometryCollection"===t[0].geometry.type&&(i=(0,k.reprojectGeoJson)(t[0],s.featureProjection,r).geometry,this.drawSource=new A.Z({features:(new R.Z).readFeatures(i)}),this.drawSource.getFeatures()[0].set("textGeometriesIndexes",t[0].properties&&t[0].properties.textGeometriesIndexes),this.drawSource.getFeatures()[0].set("textValues",t[0].properties&&t[0].properties.textValues),this.drawSource.getFeatures()[0].set("circles",t[0].properties&&t[0].properties.circles),this.drawLayer.setSource(this.drawSource))}return this.updateFeatureStyles(t),i})),Me(this,"replaceFeatures",(e=>{let t;return this.drawLayer?(this.drawSource.clear(),t=this.addFeatures(e),e.style&&this.drawLayer.setStyle((t=>{let o=h()(l()(e.features).features,(e=>e.properties.id===t.getProperties().id));if(o){let e=(0,Z.createStylesAsync)(E()(o.style));return M().all(e).then((e=>{t.setStyle((()=>(0,N.Cw)({...o,style:e})))})),null}const s=this.convertGeometryTypeToStyleType(e.drawMethod);return(0,N.Cw)({style:N.jF[s]})}))):t=this.addLayer(e,e.options&&e.options.drawEnabled||!1),t})),Me(this,"endDrawing",(e=>{const t=this.replaceFeatures(e);if(t){const o=this.fromOLFeature(t);"Circle"===e.drawMethod&&e&&e.features&&e.features.length&&e.features[0]&&e.features[0].radius>=0&&(o.radius=e.features[0].radius),this.props.onEndDrawing(o,e.drawOwner)}})),Me(this,"addDrawInteraction",((e,t,o,s)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new B.ZP(this.drawPropertiesForGeometryType(e,o,this.drawSource,s)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(e=>{const o=e.feature.clone();if(o.set("id",F().v1()),"Circle"===this.props.drawMethod&&"Circle"===o.getGeometry().getType()){const e=o.getGeometry().getRadius(),t=o.getGeometry().getCenter();o.setGeometry(this.polygonFromCircle(t,e))}const s=this.fromOLFeature(o,t);this.props.onEndDrawing(s,this.props.drawOwner),this.props.options.stopAfterDrawing&&this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,this.props.features.concat([s])),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),Me(this,"toMulti",(e=>"Point"===e.getType()?new H.Z([e.getCoordinates()]):e)),Me(this,"handleDrawAndEdit",((e,t,o,s)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new B.ZP(this.drawPropertiesForGeometryType((0,I.getSimpleGeomType)(e),o,(0,I.isSimpleGeomType)(e)?this.drawSource:null,s)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(o=>{const r=o.feature.clone(),i=F().v1();r.set("id",i);let n,a,p,c=r.getGeometry(),u=this.drawLayer.getSource().getFeatures(),d=this.props.features;if(this.props.options.transformToFeatureCollection){let t;if("Circle"===e){let e,r,n;if(p="Polygon",this.props.options.geodesic){r=o.feature.getGeometry().geodesicCenter||(0,we.qg)(c.getExtent());const t=this.props.map.getView().getProjection().getCode(),s=[[...r],[...c.getCoordinates()[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,t)));e=(0,k.calculateDistance)(s,"haversine"),n=(0,U.iu)(s[0],e).clone().transform("EPSG:4326",t).getCoordinates()}else e=c.getRadius(),r=c.getCenter(),n=this.polygonCoordsFromCircle(r,e);t=this.getNewFeature(p,n),r=(0,k.reproject)(r,this.getMapCrs(),"EPSG:4326",!1);const a=s&&s.features&&s.features.length&&s.features[0]&&s.features[0].features&&s.features[0].features.length&&s.features[0].features.filter((e=>e.properties.isDrawing))[0].properties.id||i;t.setProperties({isCircle:!0,radius:e,center:[r.x,r.y],id:a,crs:this.getMapCrs(),isGeodesic:this.props.options.geodesic})}else if("Polygon"===e){p=this.props.drawMethod;let e=c.getCoordinates();e[0].push(e[0][0]),t=this.getNewFeature(p,e)}else{p="Text"===e?"Point":this.props.drawMethod;let o=c.getCoordinates();t=this.getNewFeature(p,o),"Text"===e&&t.setProperties({isText:!0,valueText:"."})}const r=u.length>=1?[...this.replaceCirclesWithPolygonsInFeatureColl(u)]:[];t.getProperties().id||t.setProperties({id:F().v1()});const n=[...r,t];let a=Ie.writeFeaturesObject(n);const l=new A.Z({features:(new R.Z).readFeatures(a)});this.drawLayer.setSource(l);let h=(0,k.reprojectGeoJson)(a,this.getMapCrs(),"EPSG:4326");this.props.onGeometryChanged([h],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(h,this.props.drawOwner),this.props.onDrawingFeatures([v()(h.features)])}else{if("Circle"===e){p="Polygon";const e=c.getRadius(),t=c.getCenter(),o=this.polygonCoordsFromCircle(t,e),s=this.toMulti(this.createOLGeometry({type:p,coordinates:o}));if(1===d.length&&d[0]&&!d[0].geometry)n=[],a=new $.default([s]);else if(n=this.toMulti(l()(u).getGeometry()),n.getGeometries){const e=this.replaceCirclesWithPolygons(l()(u));a=new $.default([...e,s])}else a=new $.default([n,s]);r.setGeometry(a)}else if("Text"===e||"MultiPoint"===e){let e=c.getCoordinates();p="MultiPoint";let t=this.toMulti(this.createOLGeometry({type:p,coordinates:[e]}));if(1!==d.length||d[0].geometry)if(n=this.toMulti(l()(u).getGeometry()),n.getGeometries){let e=this.replaceCirclesWithPolygons(l()(u));a=new $.default([...e,t])}else a=n.clone(),a.appendPoint(t.getPoint(0));else n=[],a=t.clone();r.setGeometry(a)}else if(!(0,I.isSimpleGeomType)(e)){let t;a=null,n=1!==d.length||d[0].geometry?this.toMulti(l()(u).getGeometry()):this.toMulti(this.createOLGeometry({type:e,coordinates:null}));let o=u.map((e=>"GeometryCollection"===e.getGeometry().getType()?e.getGeometry().getGeometries():e.getGeometry()));"GeometryCollection"===u[0].getGeometry().getType()&&(o=o[0]);let s=h()(o,(t=>t.getType()===e));if(s?this.appendToMultiGeometry(e,s,c):t=this.toMulti(this.createOLGeometry({type:e,coordinates:c.getCoordinates()})),c.getType()!==(0,I.getSimpleGeomType)(n.getType())){let o=l()(u).getGeometry().getGeometries?this.replaceCirclesWithPolygons(l()(u)):[];if(s){let e=o.map((e=>e.getType()===s.getType()?s:e));a=new $.default(e)}else a="GeometryCollection"===n.getType()?new $.default([...o,t]):"Text"===e?new $.default([t]):new $.default([n,t]);r.setGeometry(a)}else r.setGeometry(s)}let o=this.props.features[0].properties;"Text"===e&&(o=T()({},this.props.features[0].properties,{textValues:(this.props.features[0].properties.textValues||[]).concat(["."]),textGeometriesIndexes:(this.props.features[0].properties.textGeometriesIndexes||[]).concat([r.getGeometry().getGeometries().length-1])})),"Circle"===e&&(o=T()({},o,{circles:(this.props.features[0].properties.circles||[]).concat([r.getGeometry().getGeometries().length-1])}));let s=this.fromOLFeature(r,t,o);const i=new A.Z({features:(new R.Z).readFeatures(s)});this.drawLayer.setSource(i);let m=(0,k.reprojectGeoJson)(Ie.writeFeatureObject(r.clone()),this.getMapCrs(),"EPSG:4326");"Polygon"===m.geometry.type&&m.geometry.coordinates[0].push(m.geometry.coordinates[0][0]),this.props.onGeometryChanged([m],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(s,this.props.drawOwner),s=(0,k.reprojectGeoJson)(s,this.getMapCrs(),"EPSG:4326");const g=(0,I.isSimpleGeomType)(this.props.drawMethod)&&"GeometryCollection"!==this.props.features[0].geometry.type?this.props.features.map((e=>({...e,featureProjection:this.getMapCrs()}))).concat([{...s,type:"Feature",geometry:{type:s.type,coordinates:s.coordinates},featureProjection:this.getMapCrs(),properties:o}]):[{...s,properties:o}];this.props.options.stopAfterDrawing?this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,g):this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,g.map((e=>(0,k.reprojectGeoJson)(e,"EPSG:4326",this.getMapCrs()))),T()({},this.props.options,{featureProjection:this.getMapCrs()})),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))}})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),Me(this,"drawPropertiesForGeometryType",(function(t,o,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={source:e.drawSource||s,type:t,style:"Marker"===t?(0,N.Fc)(r.style):new J.default({fill:new Q.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ee.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new oe.default({radius:5,stroke:new ee.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new Q.default({color:"rgba(255, 255, 255, 0.2)"})})}),features:new se.Z,condition:re.Bx},n={};switch(t){case"BBOX":n.type="LineString",n.maxPoints=2,n.geometryFunction=function(e,t){let o=t;o||(o=new U.ZP([]));let s=e[0],r=e[1];return o.setCoordinates([[s,[s[0],r[1]],r,[r[0],s[1]],s]]),o};break;case"Circle":n.maxPoints=100,r.options&&r.options.geodesic?n.geometryFunction=(t,o)=>{let s=o;s||(s=new U.ZP([]),s.setProperties({geodesicCenter:[...t[0]]},!0));let r=e.props.map.getView().getProjection().getCode(),i=[...t].map((t=>e.reprojectCoordinatesToWGS84(t,r))),n=(0,k.calculateDistance)(i,"haversine"),a=(0,U.iu)(i[0],n).clone().transform("EPSG:4326",r).getCoordinates();return s.setCoordinates(a),s}:n.type=t;break;case"Marker":case"Point":case"Text":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":{"LineString"===t&&(n.maxPoints=o);let s="Text"===t||"Marker"===t?"Point":t;n.type=s,n.geometryFunction=(t,o)=>{let i=o;return i||(i=e.createOLGeometry({type:s,coordinates:null,options:r.options})),i.setCoordinates(t),i};break}default:return{}}return T()({},i,n)})),Me(this,"setDoubleClickZoomEnabled",(e=>{let t=this.props.map.getInteractions();for(let o=0;o<t.getLength();o++){let s=t.item(o);if(s instanceof ie.Z){s.setActive(e);break}}})),Me(this,"updateFeatureExtent",(e=>{const t=e.features.getArray(),o=this.props.features.map((e=>{const o=l()(t.filter((t=>this.fromOLFeature(t).id===e.id)));return o?T()({},e,{geometry:o.geometry,center:o.center,extent:o.extent,coordinate:o.coordinates,radius:o.radius}):e}));this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,o)})),Me(this,"addInteractions",(e=>{this.clean(),this.drawLayer||this.addLayer(e),this.addDrawInteraction(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e),e.options&&e.options.editEnabled&&(this.addSelectInteraction(),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new me({features:this.selectInteraction.getFeatures()}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",this.updateFeatureExtent),this.props.map.addInteraction(this.translateInteraction),this.addTranslateListener(),this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction),this.modifyInteraction=new Oe({features:this.selectInteraction.getFeatures(),condition:e=>(0,re.Xp)(e)&&!(0,re.Ko)(e)}),this.props.map.addInteraction(this.modifyInteraction)),this.drawSource.clear(),e.features.length>0&&this.addFeatures(e)})),Me(this,"addSingleClickListener",((e,t)=>t.map.on("singleclick",e))),Me(this,"addDrawOrEditInteractions",(e=>{this.state&&this.state.keySingleClickCallback&&(0,Ge.B)(this.state.keySingleClickCallback);this.clean();let t,o=e.features.map((t=>(0,k.reprojectGeoJson)(t,e.options.featureProjection,this.getMapCrs())||{}));const s=o.every((e=>!!(e&&e.features&&e.features.length))),r=o.every((e=>!!(e&&e.properties&&e.properties.isCircle)));if(s)t=T()({},e,{features:o});else if(r)t=T()({},e,{features:[]});else{const s=o.reduce(((e,t)=>t.geometry?[...e,{...t.geometry,properties:t.properties}]:e),[]);t=T()({},e,{features:s})}this.drawLayer?(this.drawSource.clear(),this.addFeatures(t)):this.addLayer(t),e.options.editEnabled&&(!e.options.geodesic&&this.addModifyInteraction(e),!1!==e.options.translateEnabled&&this.addTranslateInteraction(),e.options.addClickCallback&&this.setState({keySingleClickCallback:this.addSingleClickListener((t=>{if(this.drawSource&&e.options){let o=this.drawSource.getFeatures(),s=0;const r=o&&o.length&&o.filter(((e,t)=>(e.getProperties().canEdit&&(s=t),e.getProperties().canEdit)))[0]||null,i=r&&r.getGeometry()&&r.getGeometry().getCoordinates&&r.getGeometry().getCoordinates()||[];let n,a=[],l=e.drawMethod;switch(l){case"Polygon":i.length?(0,D.F7)(i)?(a=u()(i[0],0,i[0].length-1),a=a.concat([t.coordinate]),a=[a.concat([i[0][0]])]):a=i[0].length>1?[[...i[0],t.coordinate,i[0][0]]]:[[...i[0],t.coordinate]]:a=[[t.coordinate]],n=this.getNewFeature(l,a),n.setProperties(m()(r&&r.getProperties()||{},"geometry"));break;case"LineString":case"MultiPoint":a=i.length?[...i,t.coordinate]:[t.coordinate],n=this.getNewFeature(l,a),n.setProperties(m()(r&&r.getProperties()||{},"geometry"));break;case"Circle":{l="Polygon";const o=r&&r.getProperties()&&r.getProperties().radius||1e4;let s=t.coordinate,i=this.polygonCoordsFromCircle(s,o);if(e.options.geodesic){const e=this.props.map.getView().getProjection().getCode(),t=[[...s]].map((t=>this.reprojectCoordinatesToWGS84(t,e)));i=(0,U.iu)(t[0],o).clone().transform("EPSG:4326",e).getCoordinates()}n=this.getNewFeature(l,i),s=(0,k.reproject)(s,this.getMapCrs(),"EPSG:4326",!1),n.setProperties(m()(r&&r.getProperties()||{},"geometry")),n.setProperties({isCircle:!0,radius:o,center:[s.x,s.y],isGeodesic:this.props.options.geodesic});break}case"Text":l="Point",n=this.getNewFeature(l,t.coordinate),n.setProperties(m()(r&&r.getProperties()||{},"geometry")),n.setProperties({isText:!0,valueText:r&&r.getProperties()&&r.getProperties().valueText||e.options.defaultTextAnnotation||"New"});break;default:a=t.coordinate,n=this.getNewFeature(l,a),n.setProperties(m()(r&&r.getProperties()||{},"geometry"))}let p={type:"Feature",geometry:{coordinates:[...(0,k.reprojectGeoJson)(Ie.writeFeaturesObject([n.clone()]),this.getMapCrs(),"EPSG:4326").features[0].geometry.coordinates],type:l},properties:{...m()(n.getProperties(),"geometry")}};this.props.onDrawingFeatures([p]),e.options.geodesic||(n=(0,j.a)(n,this.getMapCrs())),o[s]=n,this.drawSource=new A.Z({features:o}),this.drawLayer.setSource(this.drawSource),this.addModifyInteraction(e)}}),e)})),e.options&&e.options.selectEnabled&&this.addSelectInteraction(e.options&&e.options.selected,e),e.options.drawEnabled&&this.handleDrawAndEdit(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e)})),Me(this,"addSelectInteraction",((e,t)=>{let o;if(this.selectInteraction&&this.props.map.removeInteraction(this.selectInteraction),e&&(o=h()(this.drawSource.getFeatures(),(t=>t.getProperties().id===e.properties.id)),o&&this.selectFeature(o)),this.selectInteraction=new Fe.Z({layers:[this.drawLayer],features:new se.Z(e&&o?[o]:null)}),o){const e=this.convertGeometryTypeToStyleType(t.drawMethod);o.setStyle((0,N.C2)({...t,style:{...t.style,type:e,highlight:!0,useSelectedStyle:t.options.useSelectedStyle}},!1,t.features[0]&&t.features[0].properties&&t.features[0].properties.valueText&&[t.features[0].properties.valueText]||[]))}this.selectInteraction.on("select",(e=>{let t=this.selectInteraction.getFeatures().getArray(),o=[];return t.length&&(o=this.props.features.map((o=>{let s=!1;if("FeatureCollection"===o.type&&t.length>0){let e=l()(t);if(this.selectFeature(e),e.getGeometry&&"Circle"===e.getGeometry().getType()){let t=e.getGeometry().getRadius(),o=(0,k.reproject)(e.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326");e.setProperties({center:[o.x,o.y],radius:t}),e=this.replaceCircleWithPolygon(e.clone())}return this.drawSource.getFeatures().forEach((t=>{t.getProperties().id===e.getProperties().id?this.selectFeature(e):this.deselectFeature(t)})),(0,k.reprojectGeoJson)(Ie.writeFeatureObject(e.clone()),this.getMapCrs(),"EPSG:4326")}return s=t.reduce(((e,t)=>t.get("id")===o.id||e),!1),T()({},o,{selected:s,selectedFeature:e.selected})})),this.props.onSelectFeatures(o)),0===t.length?(this.props.onSelectFeatures([]),this.drawSource.getFeatures().map((e=>this.deselectFeature(e))),null):null})),this.props.map.addInteraction(this.selectInteraction)})),Me(this,"selectFeature",(e=>{e.setProperties({selected:!0})})),Me(this,"deselectFeature",(e=>{e.setProperties({selected:!1})})),Me(this,"removeDrawInteraction",(()=>{this.drawInteraction&&(this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,setTimeout((()=>this.props.map.enableEventListener("singleclick")),500),setTimeout((()=>this.setDoubleClickZoomEnabled(!0)),250))})),Me(this,"removeInteractions",(()=>{this.removeDrawInteraction(),this.selectInteraction&&(this.props.map.enableEventListener("singleclick"),this.props.map.removeInteraction(this.selectInteraction)),this.modifyInteraction&&(this.props.map.removeInteraction(this.modifyInteraction),this.props.map.un("singleclick")),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction)})),Me(this,"clean",(e=>{e||this.removeInteractions(),this.drawLayer&&(this.props.map.removeLayer(this.drawLayer),this.geojson=null,this.drawLayer=null,this.drawSource=null)})),Me(this,"fromOLFeature",((e,t,o)=>{const s=e.getGeometry(),r=this.props.map.getView().getProjection().getCode(),i=s.getType();if(s.getCoordinates){const o=s.getExtent(),a=s.getProperties(),l=a&&a.geodesicCenter||(0,we.qg)(o);let p,h=s.getCoordinates();if(t&&(h=n()(t,h),s.setCoordinates(h)),"Circle"===this.props.drawMethod)if(this.props.options.geodesic){const e=[[...l],[...h[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,r)));p=(0,k.calculateDistance)(e,"haversine")}else p=this.calculateRadius(l,h);return T()({},{id:e.get("id"),type:i,extent:o,center:l,coordinates:h,radius:p,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}let a=s.getGeometries().map(((s,i)=>{const a=s.getExtent(),l=(0,we.qg)(a);let p,h=s.getCoordinates();if(t&&(h=n()(t,h),s.setCoordinates(h)),o.circles&&-1!==o.circles.indexOf(i))if(this.props.options.geodesic){const e=[[...l],[...h[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,r)));p=(0,k.calculateDistance)(e,"haversine")}else p=this.calculateRadius(l,h);else p=0;return T()({},{id:e.get("id"),type:s.getType(),extent:a,center:l,coordinates:h,radius:p,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}));return T()({},{type:"Feature",id:e.get("id"),style:this.fromOlStyle(e.getStyle()),geometry:{type:"GeometryCollection",geometries:a},projection:r})})),Me(this,"reprojectCoordinatesToWGS84",((e,t)=>{let o=(0,k.reproject)(e,t,"EPSG:4326");return[o.x,o.y]})),Me(this,"toOlFeature",(e=>l()(this.drawSource.getFeatures().filter((t=>t.get("id")===e.id))))),Me(this,"fromOlStyle",(e=>e?{fillColor:this.rgbToHex(e.getFill().getColor()),fillTransparency:e.getFill().getColor()[3],strokeColor:e.getStroke().getColor(),strokeWidth:e.getStroke().getWidth(),text:e.getText().getText()}:{})),Me(this,"toOlStyle",((e,t,o)=>{let s=e&&e.fillColor?e.fillColor:[255,255,255,.2];"string"==typeof s&&(s=this.hexToRgb(s).concat([e.fillOpacity>=0&&e.fillOpacity<=1?e.fillOpacity:1])),e&&e.fillTransparency&&(s[3]=e.fillTransparency);let r=e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#ffcc33";t&&(r="#4a90e2"),r=this.hexToRgb(r).concat([e&&e.opacity||1]);let i=new J.default({fill:new Q.default({color:s}),stroke:new ee.default({color:r,width:e&&(e.strokeWidth||e.weight)?e.strokeWidth||e.weight:2}),text:new te.default({text:e&&e.text?e.text:"",fill:new Q.default({color:e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#000"}),stroke:new ee.default({color:"#fff",width:2}),font:e&&e.fontSize?e.fontSize+"px helvetica":""})});return"GeometryCollection"===o?[...(0,N.EC)({style:{iconGlyph:"comment",iconShape:"square",iconColor:"blue"}}),i]:e&&(e.iconUrl||e.iconGlyph)?(0,N.EC)({style:e}):i})),Me(this,"hexToRgb",(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,o,s){return t+t+o+o+s+s})));return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null})),Me(this,"componentToHex",(e=>{var t=e.toString(16);return 1===t.length?"0"+t:t})),Me(this,"rgbToHex",(e=>"#"+this.componentToHex(e[0])+this.componentToHex(e[1])+this.componentToHex(e[2]))),Me(this,"addModifyInteraction",(e=>{this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction);const t=e&&e.options&&e.options.editFilter;this.modifyFeatureColl=new se.Z(w()(this.drawLayer.getSource().getFeatures(),t)),this.modifyInteraction=new Oe({features:this.modifyFeatureColl,condition:e=>(0,re.Xp)(e)&&!(0,re.Ko)(e)}),this.modifyInteraction.on("modifyend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let o=(0,k.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),s=t.getGeometry().getRadius();t.setProperties({center:[o.x,o.y],radius:s}),e.setProperties({center:[o.x,o.y],radius:s}),t=this.replaceCircleWithPolygon(t.clone())}return(0,k.reprojectGeoJson)(Ie.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,!1,"editing","editing")})),this.props.map.addInteraction(this.modifyInteraction)})),Me(this,"addTranslateInteraction",(()=>{this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new me({features:new se.Z(this.drawLayer.getSource().getFeatures())}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let e=(0,k.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),o=t.getGeometry().getRadius();t.setProperties({center:[e.x,e.y],radius:o}),t=this.replaceCircleWithPolygon(t)}return e.getProperties()&&e.getProperties().selected&&this.props.onSelectFeatures([(0,k.reprojectGeoJson)(Ie.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")]),(0,k.reprojectGeoJson)(Ie.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,this.props.drawOwner,!1,"Text"===this.props.drawMethod,"Circle"===this.props.drawMethod)})),this.addTranslateListener(),this.props.map.addInteraction(this.translateInteraction)})),Me(this,"createOLGeometry",(e=>{let{type:t,coordinates:o,radius:s,center:r,geometries:i,projection:n,options:a={}}=e;return"GeometryCollection"===t?i&&i.length?new $.default(i.map((e=>this.olGeomFromType({type:e.type})))):new $.default([]):this.olGeomFromType({type:t,coordinates:o,radius:s,center:r,projection:n,options:a})})),Me(this,"olGeomFromType",(e=>{let t,{type:o,coordinates:s,radius:r,center:i,projection:n,options:a}=e;switch(o){case"Point":case"Marker":case"Text":t=new W.Z(s||[]);break;case"LineString":t=new q.Z(s||[]);break;case"MultiPoint":t=new H.Z(s||[]);break;case"MultiLineString":t=new K.Z(s||[]);break;case"MultiPolygon":t=new X.Z(s||[]);break;default:{let e=y()(i)?{x:i[0],y:i[1]}:i;const o=n&&!isNaN(parseFloat(r))&&e&&!x()(e.x)&&!x()(e.y)&&!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y));t=o?a.geodesic?(0,U.iu)(this.reprojectCoordinatesToWGS84([e.x,e.y],n),r,100).clone().transform("EPSG:4326",n):(0,U.Bb)(new Y.Z([e.x,e.y],r),100):new U.ZP(s&&y()(s[0])?s:[]),t&&o&&a.geodesic&&t.setProperties({geodesicCenter:[e.x,e.y]},!0)}}return t})),Me(this,"convertGeometryTypeToStyleType",(e=>"BBOX"===e?"LineString":e)),Me(this,"appendToMultiGeometry",((e,t,o)=>{switch(e){case"MultiPoint":t.appendPoint(o);break;case"MultiLineString":t.appendLineString(o);break;case"MultiPolygon":{let e=o.getCoordinates();e[0].push(e[0][0]),o.setCoordinates(e),t.appendPolygon(o);break}}})),Me(this,"calculateRadius",((e,t)=>y()(t)&&y()(t[0])&&y()(t[0][0])?Math.sqrt(Math.pow(e[0]-t[0][0][0],2)+Math.pow(e[1]-t[0][0][1],2)):100)),Me(this,"polygonFromCircle",(function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(0,U.Bb)(new Y.Z(e,t),o)})),Me(this,"polygonCoordsFromCircle",(function(t,o){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return e.polygonFromCircle(t,o,s).getCoordinates()})),Me(this,"replaceCirclesWithPolygonsInFeatureColl",(e=>e.map((e=>"Circle"!==e.getGeometry().getType()?e:this.replaceCircleWithPolygon(e))))),Me(this,"replaceCircleWithPolygon",(e=>{if(e.getProperties().isCircle&&"Circle"===e.getGeometry().getType()){const t=e.getGeometry().getCenter(),o=e.getGeometry().getRadius();return e.setGeometry(this.polygonFromCircle(t,o)),e}return e})),Me(this,"replaceCirclesWithPolygons",(e=>e.getGeometry&&!e.getGeometry().getGeometries?e:e.getGeometry().getGeometries().map(((t,o)=>{if("Circle"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(o)){const e=t.getCenter(),o=t.getRadius();return this.polygonFromCircle(e,o)}return t})))),Me(this,"replacePolygonsWithCircles",(e=>e.getGeometry().getGeometries().map(((t,o)=>{if("Polygon"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(o)){const e=t.getExtent(),o=(0,we.qg)(e),s=this.calculateRadius(o,t.getCoordinates());return new Y.Z(o,s)}return t})))),Me(this,"addTranslateListener",(()=>{document.addEventListener("keydown",(e=>{e.altKey&&"AltLeft"===e.code&&this.translateInteraction.setActive(!0)})),document.addEventListener("keyup",(e=>{"AltLeft"===e.code&&this.translateInteraction.setActive(!1)}))}))}UNSAFE_componentWillReceiveProps(e){if(this.drawLayer&&this.updateFeatureStyles(e.features),!e.drawStatus&&this.selectInteraction&&this.selectInteraction.getFeatures().clear(),this.props.drawStatus!==e.drawStatus||this.props.drawMethod!==e.drawMethod||this.props.features!==e.features)switch(e.drawStatus){case"create":this.addLayer(e);break;case"start":this.addInteractions(e);break;case"drawOrEdit":this.addDrawOrEditInteractions(e);break;case"stop":this.removeDrawInteraction();break;case"replace":this.replaceFeatures(e);break;case"updateStyle":this.updateOnlyFeatureStyles(e);break;case"clean":this.clean();break;case"cleanAndContinueDrawing":this.clean(!0);break;case"endDrawing":this.endDrawing(e);break;default:return}}render(){return null}}Me(ke,"propTypes",{map:P().object,drawOwner:P().string,drawStatus:P().string,drawMethod:P().string,options:P().object,features:P().array,onChangeDrawingStatus:P().func,onGeometryChanged:P().func,onDrawStopped:P().func,onDrawingFeatures:P().func,onSelectFeatures:P().func,onEndDrawing:P().func,style:P().object}),Me(ke,"defaultProps",{map:null,drawOwner:null,drawStatus:null,drawMethod:null,features:null,options:{stopAfterDrawing:!0},onChangeDrawingStatus:()=>{},onGeometryChanged:()=>{},onDrawStopped:()=>{},onDrawingFeatures:()=>{},onSelectFeatures:()=>{},onEndDrawing:()=>{}})},39452:(e,t,o)=>{"use strict";o.d(t,{Z:()=>x});var s=o(24852),r=o.n(s),i=o(45697),n=o.n(i),a=o(9669),l=o.n(a),p=o(18446),h=o.n(p),c=o(52353),u=o.n(c),d=o(13311),m=o.n(d),g=o(84596),y=o.n(g),f=o(80034),v=o(80543),_=o(79055),w=o(69141);function b(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class x extends r().Component{constructor(){super(...arguments),b(this,"addFeatures",(e=>{const t=new w.Z;let o=null,s=!1;"FeatureCollection"===e.type?(o={features:u()(e.properties.visibility)||e.properties.visibility?e.features:[]},s=!!e.features):(o={geometry:e.geometry},s=!(!e.geometry||!e.geometry.geometries&&!e.geometry.coordinates)),e.container&&s&&(this._feature=t.readFeatures({type:e.type,properties:e.properties,id:e.msId,...o},{dataProjection:e.featuresCrs}),this._feature.map((t=>{let o=t;return t.getProperties().isCircle&&(o=(0,v.a)(t,e.crs||"EPSG:3857",e.featuresCrs),o.setGeometry(o.getGeometry().transform(e.crs||"EPSG:3857",e.featuresCrs))),o})).forEach((t=>t.getGeometry().transform(e.featuresCrs,e.crs||"EPSG:3857"))),e.style&&e.style!==e.layerStyle&&this._feature.forEach((t=>{let o=[],s={};"FeatureCollection"===e.type?(s=m()(e.features,(e=>e.properties.id===t.getProperties().id)),o=(0,_.createStylesAsync)(y()(s.style))):(o=(0,_.createStylesAsync)(y()(e.style)),s={type:e.type,geometry:e.geometry,properties:e.properties,style:e.style}),l().all(o).then((e=>{t.setStyle((()=>(0,f.Cw)({...s,style:e})))}))})),e.container.getSource().addFeatures(this._feature))})),b(this,"removeFromContainer",(()=>{if(this._feature)if(Array.isArray(this._feature)){const e=this.props.container.getSource();this._feature.map((t=>{let o=t.getId();void 0!==o&&e.getFeatureById(o)?e.removeFeature(e.getFeatureById(o)):e.removeFeature(t)}))}else this.props.container.getSource().removeFeature(this._feature)}))}componentDidMount(){this.addFeatures(this.props)}shouldComponentUpdate(e){return!(h()(e.properties,this.props.properties)&&h()(e.geometry,this.props.geometry)&&h()(e.features,this.props.features)&&h()(e.crs,this.props.crs)&&h()(e.style,this.props.style))}UNSAFE_componentWillUpdate(e){this.removeFromContainer(),this.addFeatures(e)}componentWillUnmount(){this.removeFromContainer()}render(){return null}}b(x,"propTypes",{type:n().string,layerStyle:n().object,style:n().object,properties:n().object,crs:n().string,container:n().object,features:n().array,geometry:n().object,msId:n().oneOfType([n().string,n().number]),featuresCrs:n().string}),b(x,"defaultProps",{featuresCrs:"EPSG:4326"})},64775:(e,t,o)=>{"use strict";o.d(t,{Z:()=>L});var s=o(45697),r=o.n(s),i=o(24852),n=o.n(i),a=o(40392),l=o(10312),p=o(27418),h=o.n(p),c=o(49977),u=o.n(c),d=o(81763),m=o.n(d),g=o(1469),y=o.n(g),f=o(57557),v=o.n(f),_=o(18446),w=o.n(_),b=o(14293),x=o.n(b),C=o(68105);function E(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class L extends n().Component{constructor(){super(...arguments),E(this,"setLayerVisibility",(e=>{const t=this.props.options&&!1!==this.props.options.visibility,o=e.options&&!1!==e.options.visibility;o!==t&&this.layer&&this.isValid()&&this.layer.setVisible(o)})),E(this,"setLayerOpacity",(e=>{e!==(this.props.options&&void 0!==this.props.options.opacity?this.props.options.opacity:1)&&this.layer&&this.layer.setOpacity(e)})),E(this,"generateOpts",((e,t,o,s,r,i)=>{const{minResolution:n,maxResolution:a,disableResolutionLimits:l,...p}=e,c={...p,...!l&&{minResolution:n,maxResolution:a,minZoom:x()(a)?void 0:(0,C.getZoomFromResolution)(a,i),maxZoom:x()(n)?void 0:(0,C.getZoomFromResolution)(n,i)}};return h()({},c,m()(t)?{zIndex:t}:null,{srs:o,onError:()=>{this.props.onCreationError(c)},securityToken:s,env:r})})),E(this,"createLayer",((e,t,o,s,r,i)=>{if(e){const n=this.generateOpts(t,o,(0,l.normalizeSRS)(this.props.srs),s,r,i);this.layer=a.default.createLayer(e,n,this.props.map,this.props.mapId);const p=a.default.isCompatible(e,n);if(this.layer&&!this.layer.detached){const e=this.props.map,o=e&&e.getView().getProjection().getExtent(),s=t&&t.bbox&&t.bbox.bounds,r=o&&(0,l.reprojectBbox)(o,this.props.srs,"EPSG:4326");let i=s&&(0,l.reprojectBbox)((0,l.getExtentFromNormalized)(s,this.props.srs).extent,"EPSG:4326");i&&2===i.length&&y()(i[1])&&(i=i[1]),(r&&i&&!(0,l.isBboxCompatible)((0,l.getPolygonFromExtent)(r),(0,l.getPolygonFromExtent)(i))||!p)&&this.props.onWarning({title:"warning",message:"notification.incompatibleDataAndProjection",action:{label:"close"},position:"tc",uid:"1"}),this.addLayer(t)}this.layer&&this.layer.get&&this.layer.get("getElevation")&&this.props.map.set("elevationLayer",this.layer),this.forceUpdate()}})),E(this,"updateLayer",((e,t)=>{if(e.position===t.position&&e.srs===t.srs&&e.securityToken===t.securityToken){if(e.options===t.options)return;if(w()(v()(e.options,["loading"]),v()(t.options,["loading"])))return}const o=a.default.updateLayer(this.props.type,this.layer,this.generateOpts(e.options,e.position,e.projection,e.securityToken,e.env,e.resolutions),this.generateOpts(t.options,t.position,t.projection,t.securityToken,t.env,t.resolutions),this.props.map,this.props.mapId);o&&(this.props.map.removeLayer(this.layer),this.layer=o,this.addLayer(e.options))})),E(this,"addLayer",(e=>{if(this.isValid()){this.props.map.addLayer(this.layer);const t=new(u().Subject),o=new(u().Subject);e.handleClickOnLayer&&this.layer.set("handleClickOnLayer",!0),this.layer.getSource().on("tileloadstart",(()=>{0===this.tilestoload?(this.props.onLayerLoading(e.id),this.tilestoload++):this.tilestoload++})),this.layer.getSource().on("tileloadend",(()=>{t.next({type:"tileloadend"}),this.tilestoload--,0===this.tilestoload&&o.next()})),this.layer.getSource().on("tileloaderror",(e=>{t.next({type:"tileloaderror",event:e}),this.tilestoload--,0===this.tilestoload&&o.next()})),t.bufferWhen((()=>o)).subscribe({next:t=>{const o=t.filter((e=>"tileloaderror"===e.type));o.length>0&&(e&&!e.hideErrors||!e)?(this.props.onLayerLoad(e.id,{error:!0}),this.props.onLayerError(e.id,t.length,o.length)):this.props.onLayerLoad(e.id)}}),this.tileLoadEndStream$=t,this.tileStopStream$=o;const s=new(u().Subject),r=new(u().Subject);if(this.layer.getSource().on("imageloadstart",(()=>{0===this.imagestoload?(this.props.onLayerLoading(e.id),this.imagestoload++):this.imagestoload++})),this.layer.getSource().on("imageloadend",(()=>{this.imagestoload--,s.next({type:"imageloadend"}),0===this.imagestoload&&r.next()})),this.layer.getSource().on("imageloaderror",(e=>{this.imagestoload--,s.next({type:"imageloaderror",event:e}),0===this.imagestoload&&r.next()})),s.bufferWhen((()=>r)).subscribe({next:t=>{const o=t.filter((e=>"imageloaderror"===e.type));o.length>0?(this.props.onLayerLoad(e.id,{error:!0}),(e&&!e.hideErrors||!e)&&this.props.onLayerError(e.id,t.length,o.length)):this.props.onLayerLoad(e.id)}}),this.imageLoadEndStream$=s,this.imageStopStream$=r,this.layer.getSource().on("vectorerror",(()=>{this.props.onLayerLoad(e.id,{error:!0})})),e.refresh){let t=0;this.refreshTimer=setInterval((()=>{this.layer.getSource().updateParams(h()({},e.params,{_refreshCounter:t++}))}),e.refresh)}}})),E(this,"isValid",(()=>{const e=a.default.isValid(this.props.type,this.layer);return this.valid=e,e}))}componentDidMount(){this.valid=!0,this.tilestoload=0,this.imagestoload=0,this.createLayer(this.props.type,this.props.options,this.props.position,this.props.securityToken,this.props.env,this.props.resolutions)}UNSAFE_componentWillReceiveProps(e){this.setLayerVisibility(e);const t=e.options&&void 0!==e.options.opacity?e.options.opacity:1;this.setLayerOpacity(t),e.position!==this.props.position&&this.layer&&this.layer.setZIndex&&this.layer.setZIndex(e.position),this.props.options&&this.updateLayer(e,this.props)}componentWillUnmount(){this.layer&&this.props.map&&(this.tileLoadEndStream$&&(this.tileLoadEndStream$.complete(),this.tileStopStream$.complete(),this.imageLoadEndStream$.complete(),this.imageStopStream$.complete()),this.layer.detached?this.layer.remove():this.props.map.removeLayer(this.layer)),this.refreshTimer&&clearInterval(this.refreshTimer),a.default.removeLayer(this.props.type,this.props.options,this.props.map,this.props.mapId,this.layer)}render(){if(this.props.children){const e=this.layer,t=e?n().Children.map(this.props.children,(t=>t?n().cloneElement(t,{container:e,styleName:this.props.options&&this.props.options.styleName}):null)):null;return n().createElement(n().Fragment,null,t)}return a.default.renderLayer(this.props.type,this.props.options,this.props.map,this.props.mapId,this.layer)}}E(L,"propTypes",{onWarning:r().func,maxExtent:r().array,map:r().object,mapId:r().string,srs:r().string,type:r().string,options:r().object,onLayerLoading:r().func,onLayerError:r().func,onCreationError:r().func,onLayerLoad:r().func,position:r().number,observables:r().array,securityToken:r().string,env:r().array,resolutions:r().array}),E(L,"defaultProps",{observables:[],onLayerLoading:()=>{},onLayerLoad:()=>{},onLayerError:()=>{},onCreationError:()=>{},onWarning:()=>{},srs:"EPSG:3857"})},96047:(e,t,o)=>{"use strict";o.d(t,{Z:()=>z});var s=o(37566),r=o(73800),i=o(86306),n=o(70878),a=o(78471),l=o(76773),p=o(18672),h=o(99937),c=o(40868),u=o(21915),d=o(94401),m=o(84110),g=o(44183),y=o(45697),f=o.n(y),v=o(24852),_=o.n(v),w=o(27418),b=o.n(w),x=o(10312),C=o(54980),E=o(68105);var L=o(27568),P=o(18446),S=o.n(P),T=o(13311),O=o.n(T),F=o(23493),G=o.n(F),M=o(1469),I=o.n(M),k=o(14293),Z=o.n(k),j=o(93379),D=o.n(j),N=o(91133);D()(N.Z,{insert:"head",singleton:!1}),N.Z.locals;var R=o(14976);function V(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}D()(R.Z,{insert:"head",singleton:!1}),R.Z.locals;class A extends _().Component{constructor(){var e;super(...arguments),e=this,V(this,"getDocument",(()=>this.props.document||document)),V(this,"getResolutions",(()=>{if(this.props.mapOptions&&this.props.mapOptions.view&&this.props.mapOptions.view.resolutions)return this.props.mapOptions.view.resolutions;let e=void 0!==this.props.mapOptions.minZoom?this.props.mapOptions.minZoom:0,t=void 0!==this.props.mapOptions.maxZoom?this.props.mapOptions.maxZoom:28,o=void 0!==this.props.mapOptions.zoomFactor?this.props.mapOptions.zoomFactor:2;const s=this.map.getView().getProjection(),r=s.getExtent();let i,n,a=(r?(0,u.dz)(r):360*c.default.METERS_PER_UNIT[c.default.DEGREES]/c.default.METERS_PER_UNIT[s.getUnits()])/256,l=(r?(0,u.Cr)(r):360*c.default.METERS_PER_UNIT[c.default.DEGREES]/c.default.METERS_PER_UNIT[s.getUnits()])/256;a<=l?(i=1,n=Math.round(l/a),l/=n):(n=1,i=Math.round(a/l),a/=i);const p=Math.max(a,l),h=p/Math.pow(2,28);let d=this.props.mapOptions.maxResolution;void 0!==d?e=0:d=p/Math.pow(o,e);let m=this.props.mapOptions.minResolution;return void 0===m&&(m=void 0!==this.props.mapOptions.maxZoom?void 0!==this.props.mapOptions.maxResolution?d/Math.pow(o,t):p/Math.pow(o,t):h),t=e+Math.floor(Math.log(d/m)/Math.log(o)),Array.apply(0,Array(t-e+1)).map(((e,t)=>d/Math.pow(o,t)))})),V(this,"mouseMoveEvent",(e=>{if(!e.dragging&&e.coordinate){const t=this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation");let o=e.coordinate.slice(),s=(0,p.bU)(o,this.props.projection),r=s[0]/360%1*360;r<-180?r+=360:r>180&&(r-=360),this.props.onMouseMove({y:s[1]||0,x:r||0,z:this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation")(o,e.pixel)||void 0,crs:"EPSG:4326",pixel:{x:e.pixel[0],y:e.pixel[1]},latlng:{lat:s[1],lng:r,z:t&&t(o,e.pixel)||void 0},lat:s[1],lng:r,rawPos:e.coordinate.slice()})}})),V(this,"updateMapInfoState",(()=>{let e=this.map.getView(),t=e.getCenter(),o=e.getProjection().getExtent();const s=e.getProjection().getCode();if(-1!==["EPSG:3857","EPSG:900913","EPSG:4326"].indexOf(s)||t&&t[0]>=o[0]&&t[0]<=o[2]&&t[1]>=o[1]&&t[1]<=o[3]){let t=this.normalizeCenter(e.getCenter()),o=e.calculateExtent(this.map.getSize()),r={width:this.map.getSize()[0],height:this.map.getSize()[1]};this.props.onMapViewChanges({x:t[0]||0,y:t[1]||0,crs:"EPSG:4326"},e.getZoom(),{bounds:{minx:o[0],miny:o[1],maxx:o[2],maxy:o[3]},crs:s,rotation:e.getRotation()},r,this.props.id,this.props.projection,void 0,e.getResolution())}})),V(this,"haveResolutionsChanged",(e=>{const t=this.props.mapOptions&&this.props.mapOptions.view?this.props.mapOptions.view.resolutions:void 0,o=e.mapOptions&&e.mapOptions.view?e.mapOptions.view.resolutions:void 0;return!S()(t,o)})),V(this,"createView",(function(e,t,o,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=r.restrictedExtent&&r.crs&&(0,x.reprojectBbox)(r.restrictedExtent,r.crs,(0,x.normalizeSRS)(o)),n=!s||s&&!s.view?b()({},s,{extent:i}):b()({},s),a=b()({},{projection:(0,x.normalizeSRS)(o),center:[e.x,e.y],zoom:t,minZoom:r.minZoom},n||{});return new l.ZP(a)})),V(this,"_updateMapPositionFromNewProps",(e=>{var t=this.map.getView();const o=this.props.center;if(e.center.y!==o.y||e.center.x!==o.x){let o=(0,x.reproject)({x:e.center.x,y:e.center.y},"EPSG:4326",e.projection,!0);t.setCenter([o.x,o.y])}Math.round(e.zoom)!==this.props.zoom&&t.setZoom(Math.round(e.zoom)),(e.bbox&&void 0!==e.bbox.rotation||this.bbox&&void 0!==this.bbox.rotation&&e.bbox.rotation!==this.props.bbox.rotation)&&t.setRotation(e.bbox.rotation)})),V(this,"normalizeCenter",(e=>{let t=(0,x.reproject)({x:e[0],y:e[1]},this.props.projection,"EPSG:4326",!0);return[t.x,t.y]})),V(this,"setMousePointer",(e=>{this.map&&(this.map.getViewport().style.cursor=e||"auto")})),V(this,"registerHooks",(()=>{this.props.hookRegister.registerHook(E.default.RESOLUTIONS_HOOK,(()=>this.getResolutions())),this.props.hookRegister.registerHook(E.default.RESOLUTION_HOOK,(()=>this.map.getView().getResolution())),this.props.hookRegister.registerHook(E.default.COMPUTE_BBOX_HOOK,((e,t)=>{var o=(0,x.reproject)([e.x,e.y],"EPSG:4326",this.props.projection);let s=this.createView(o,t,this.props.projection,this.props.mapOptions&&this.props.mapOptions.view,this.props.limits),r=this.map.getSize(),i=s.calculateExtent(r);return{bounds:{minx:i[0],miny:i[1],maxx:i[2],maxy:i[3]},crs:this.props.projection,rotation:this.map.getView().getRotation()}})),this.props.hookRegister.registerHook(E.default.GET_PIXEL_FROM_COORDINATES_HOOK,(e=>this.map.getPixelFromCoordinate(e))),this.props.hookRegister.registerHook(E.default.GET_COORDINATES_FROM_PIXEL_HOOK,(e=>this.map.getCoordinateFromPixel(e))),this.props.hookRegister.registerHook(E.default.ZOOM_TO_EXTENT_HOOK,(function(t){let{padding:o,crs:s,maxZoom:r,duration:i,nearest:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,x.reprojectBbox)(t,s,e.props.projection);a&&a[0]===a[2]&&a[1]===a[3]&&"EPSG:4326"===s&&I()(t)&&-180===t[0]&&-90===t[1]&&(a=e.map.getView().getProjection().getExtent());let l=r;a&&a[0]===a[2]&&a[1]===a[3]&&Z()(l)&&(l=21),e.map.getView().fit(a,{size:e.map.getSize(),padding:o&&[o.top||0,o.right||0,o.bottom||0,o.left||0],maxZoom:l,duration:i,nearest:n})}))}))}componentDidMount(){this.props.projectionDefs.forEach((e=>{const t=d.default.defs(e.code);var o,s,r,i,n;o=e.code,s=e.extent,r=e.worldExtent,i=e.axisOrientation||t.axis||"enu",n=t.units||"m",(0,p.Sx)(new g.Z({code:o,extent:s,worldExtent:r,axisOrientation:i,units:n}))}));let e=(0,x.reproject)([this.props.center.x,this.props.center.y],"EPSG:4326",this.props.projection);!function(e){var t,o,s=Object.keys(e.defs),r=s.length;for(t=0;t<r;++t){var i=s[t];if(!(0,p.U2)(i)){var n=e.defs(i);(0,p.Sx)(new g.Z({code:i,axisOrientation:n.axis,metersPerUnit:n.to_meter,units:n.units}))}}for(t=0;t<r;++t){var a=s[t],l=(0,p.U2)(a);for(o=0;o<r;++o){var h=s[o],c=(0,p.U2)(h);if(!(0,m.U2)(a,h))if(e.defs[a]===e.defs[h])(0,p.rM)([l,c]);else{var u=e(a,h);(0,p.zY)(l,c,u.forward,u.inverse)}}}}(d.default);let t=b()(this.props.interactive?{}:{doubleClickZoom:!1,dragPan:!1,altShiftDragRotate:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1},this.props.mapOptions.interactions),o=(0,s.ce)(b()({dragPan:!1,mouseWheelZoom:!1},t,{}));void 0!==t&&void 0!==t.dragPan||(this.dragPanInteraction=new r.Z({kinetic:!1}),o.extend([this.dragPanInteraction])),void 0!==t&&void 0!==t.mouseWheelZoom||(this.mouseWheelInteraction=new i.Z({duration:0}),o.extend([this.mouseWheelInteraction]));let l=(0,n.c)(b()({zoom:this.props.zoomControl,attributionOptions:b()({collapsible:!1},this.props.mapOptions.attribution&&this.props.mapOptions.attribution.container?{target:this.getDocument().querySelector(this.props.mapOptions.attribution.container)}:{})},this.props.mapOptions.controls)),h=new a.default({layers:[],controls:l,interactions:o,maxTilesLoading:1/0,target:this.getDocument().getElementById(this.props.id)||"".concat(this.props.id),view:this.createView(e,Math.round(this.props.zoom),this.props.projection,this.props.mapOptions&&this.props.mapOptions.view,this.props.limits)});this.map=h,this.props.registerHooks&&this.registerHooks(),this.map.disabledListeners={},this.map.disableEventListener=e=>{this.map.disabledListeners[e]=!0},this.map.enableEventListener=e=>{delete this.map.disabledListeners[e]},this.map.getViewport().addEventListener("mouseout",(()=>{setTimeout((()=>this.props.onMouseOut()),150)})),h.on("moveend",this.updateMapInfoState),h.on("singleclick",(e=>{if(this.props.onClick&&!this.map.disabledListeners.singleclick){let t=this.map.getView(),o=e.coordinate.slice(),s=t.getProjection().getExtent();if("EPSG:4326"===this.props.projection&&(o[0]=(0,x.normalizeLng)(o[0])),"EPSG:900913"!==this.props.projection&&"EPSG:3857"!==this.props.projection||(o=(0,p.bU)(o,this.props.projection),s=(0,x.reprojectBbox)(s,this.props.projection,"EPSG:4326")),o[0]>=s[0]&&o[0]<=s[2]&&o[1]>=s[1]&&o[1]<=s[3]){let t,s;t="EPSG:900913"!==this.props.projection&&"EPSG:3857"!==this.props.projection?(0,x.reproject)(o,this.props.projection,"EPSG:4326"):{x:o[0],y:o[1]},this.markerPresent=!1,h.forEachFeatureAtPixel(e.pixel,((e,o)=>{if(o&&o.get("handleClickOnLayer")){const r=e.getGeometry();if(!this.markerPresent&&"Point"===r.getType()){this.markerPresent=!0,s=o.get("msId");const e=(0,p.bU)(r.getFirstCoordinate(),this.props.projection);t={x:e[0],y:e[1]}}}}));const r=(0,x.normalizeLng)(t.x),i=this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation");this.props.onClick({pixel:{x:e.pixel[0],y:e.pixel[1]},latlng:{lat:t.y,lng:r,z:i&&i(o,e.pixel)||void 0},rawPos:e.coordinate.slice(),modifiers:{alt:e.originalEvent.altKey,ctrl:e.originalEvent.ctrlKey,metaKey:e.originalEvent.metaKey,shift:e.originalEvent.shiftKey}},s)}}}));const c=G()(this.mouseMoveEvent,100);h.on("pointermove",c),this.updateMapInfoState(),this.setMousePointer(this.props.mousePointer),this.forceUpdate(),this.props.onResolutionsChange(this.getResolutions())}UNSAFE_componentWillReceiveProps(e){if(e.mousePointer!==this.props.mousePointer&&this.setMousePointer(e.mousePointer),e.zoomControl!==this.props.zoomControl&&(e.zoomControl?this.map.addControl(new h.Z):this.map.removeControl(this.map.getControls().getArray().filter((e=>e instanceof h.Z))[0])),this.map&&(this.props.mapOptions&&this.props.mapOptions.interactions)!==(e.mapOptions&&e.mapOptions.interactions)){const t=e.mapOptions.interactions||{},o=this.map.getInteractions().getArray();Object.keys(t).forEach((e=>{const{Instance:s,options:r}=L.hH[e]||{};let i=O()(o,(t=>L.hH[e]&&t instanceof s));i?i.setActive(t[e]):t[e]&&s&&this.map.addInteraction(new s(r))}))}if(this.map&&this.props.id!==e.mapStateSource&&this._updateMapPositionFromNewProps(e),this.map&&e.resize!==this.props.resize&&setTimeout((()=>{this.map.updateSize()}),0),this.map&&(this.props.projection!==e.projection||this.haveResolutionsChanged(e))||this.props.limits!==e.limits){if(this.props.projection!==e.projection||this.props.limits!==e.limits){let t=e.projection;const o=(0,x.reproject)([e.center.x,e.center.y],"EPSG:4326",t);this.map.setView(this.createView(o,e.zoom,e.projection,e.mapOptions&&e.mapOptions.view,e.limits)),this.props.onResolutionsChange(this.getResolutions())}this.map.getLayers().forEach((e=>{let t=e.getSource();t.getTileLoadFunction&&t.setTileLoadFunction(t.getTileLoadFunction())})),this.map.render()}}componentWillUnmount(){const e=this.props.mapOptions.attribution&&this.props.mapOptions.attribution.container&&this.getDocument().querySelector(this.props.mapOptions.attribution.container);if(e&&e.querySelector(".ol-attribution"))try{e.removeChild(e.querySelector(".ol-attribution"))}catch(e){}this.map&&this.map.setTarget(null)}render(){const e=this.map,t=e?_().Children.map(this.props.children,(t=>t?_().cloneElement(t,{map:e,mapId:this.props.id,onLayerLoading:this.props.onLayerLoading,onLayerError:this.props.onLayerError,onLayerLoad:this.props.onLayerLoad,projection:this.props.projection,onCreationError:this.props.onCreationError,resolutions:this.getResolutions()}):null)):null;return _().createElement("div",{id:this.props.id,style:this.props.style},t)}}V(A,"propTypes",{id:f().string,document:f().object,style:f().object,center:C.ZP.PropTypes.center,zoom:f().number.isRequired,mapStateSource:C.ZP.PropTypes.mapStateSource,projection:f().string,projectionDefs:f().array,onMapViewChanges:f().func,onResolutionsChange:f().func,onClick:f().func,mapOptions:f().object,zoomControl:f().bool,mousePointer:f().string,onMouseMove:f().func,onLayerLoading:f().func,onLayerLoad:f().func,onLayerError:f().func,resize:f().oneOfType([f().number,f().string]),measurement:f().object,changeMeasurementState:f().func,registerHooks:f().bool,hookRegister:f().object,interactive:f().bool,onCreationError:f().func,bbox:f().object,wpsBounds:f().object,onWarning:f().func,maxExtent:f().array,limits:f().object,onMouseOut:f().func}),V(A,"defaultProps",{id:"map",onMapViewChanges:()=>{},onResolutionsChange:()=>{},onCreationError:()=>{},onClick:null,onMouseMove:()=>{},mapOptions:{},projection:"EPSG:3857",projectionDefs:[],onLayerLoading:()=>{},onLayerLoad:()=>{},onLayerError:()=>{},resize:0,registerHooks:!0,hookRegister:E.default,interactive:!0,onMouseOut:()=>{},center:{x:13,y:45,crs:"EPSG:4326"},zoom:5});const z=A},17432:(e,t,o)=>{"use strict";o.d(t,{Z:()=>R});var s=o(24852),r=o.n(s),i=o(45697),n=o.n(i),a=o(59854),l=o.n(a),p=o(27361),h=o.n(p),c=o(18446),u=o.n(c),d=o(43624),m=o.n(d),g=o(10928),y=o.n(g),f=o(10312),v=o(39859),_=o(94310),w=o(80034),b=o(99677),x=o(27568),C=o(44538),E=o(40353),L=o(93409),P=o(97016),S=o(29902),T=o(23068),O=o(31219),F=o(98185),G=o(20767),M=o(9371),I=o(72445),k=o(69141),Z=o(56834),j=o(70295);function D(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const N=e=>e.getView().getProjection().getCode();class R extends r().Component{constructor(){var e;super(...arguments),e=this,D(this,"getLength",((e,t)=>{if("Bearing"===t.measurement.geomType&&e.length>1)return(0,f.calculateAzimuth)(e[0],e[1],N(t.map));const o=this.reprojectedCoordinatesIn4326(e);return(0,f.calculateDistance)(o,t.measurement.lengthFormula)})),D(this,"getArea",(e=>this.calculateGeodesicArea(e.getLinearRing(0).getCoordinates()))),D(this,"updateInteraction",((e,t)=>{t.some((e=>h()(e,"properties.disabled")))?this.removeDrawInteraction():null===this.drawInteraction&&(this.restoreDrawState(),this.addDrawInteraction(e))})),D(this,"convertPolyToLineFeature",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=[];const s=(0,v.wd)(t[0]);return s&&(0,v.wd)(t[1])?o=e.reprojectedCoordinatesFrom4326([t[0],t[1]]):s&&(o=e.reprojectedCoordinatesFrom4326([t[0]])),o.length?new C.Z(o):null})),D(this,"modifyFeatures",(e=>{var t,o,s,r;let{currentFeature:i,features:n}=e.measurement||{},a=(null===(t=n[i])||void 0===t||null===(o=t.geometry)||void 0===o?void 0:o.coordinates)||[],l=(null===(s=n[i])||void 0===s||null===(r=s.geometry)||void 0===r?void 0:r.type)||"";var p;"Polygon"===l&&(a=(null===(p=a)||void 0===p?void 0:p[0])||[]);const h=a.length,c=a.some((e=>!(0,v.wd)(e)));let d;if(!c&&"LineString"===l&&h<2){const e=this.reprojectedCoordinatesFrom4326(a);d=new C.Z(e),n[i]=(0,_.t8)("properties.disabled",!0,(0,_.t8)("geometry.coordinates",[...a,["",""]],n[i]))}else!c&&"Polygon"===l&&h<=4&&u()(a[h-1],a[h-2])&&(a.splice(2,0,["",""]),a.pop(),n[i]=(0,_.t8)("properties.disabled",!0,(0,_.t8)("geometry.coordinates",[a],n[i])));var m,g,y,f;let w;return"Polygon"===l&&h<=4&&(d=this.convertPolyToLineFeature(a)),!c&&u()(a[h-1],a[h-2])&&(null===(m=n[i])||void 0===m||null===(g=m.geometry)||void 0===g||null===(y=g.coordinates)||void 0===y||null===(f=y[0])||void 0===f||f.pop()),d&&(this.source.clear(),w=new T.Z({geometry:d})),[n,w]})),D(this,"updateFeatures",(e=>{const[t,o]=this.modifyFeatures(e)||[],s=this.source.getFeatures();this.removeMeasureTooltips(),this.removeSegmentLengthOverlays(),this.source.clear(),this.textLabels=[],this.segmentLengths=[];let r=null;this.updateInteraction(e,t);const i=t.map(((t,i)=>{if(h()(t,"properties.disabled"))return r=i,[t,s&&s[i]&&s[i].getGeometry()||(null==o?void 0:o.getGeometry())];const n=t.geometry.type,a=h()(t,"properties.values",[]),l="bearing"===(a[0]||{}).type||!(a[0]||{}).type&&e.measurement.bearingMeasureEnabled,p="Polygon"===n?t.geometry.coordinates[0]:t.geometry.coordinates;let c=p;"LineString"===n&&p.length>=2&&!l&&(c=(0,f.transformLineToArcs)(p));const u=this.reprojectedCoordinatesFrom4326(c),d="Polygon"===n?new E.ZP([u]):new C.Z(u),m={Point:()=>p,LineString:()=>l?(0,f.calculateAzimuth)(p[0],p[1],"EPSG:4326"):(0,f.calculateDistance)(p,e.measurement.lengthFormula),Polygon:()=>this.getArea(d)},g={LineString:()=>this.formatLengthValue(l?(0,f.calculateAzimuth)(p[0],p[1],"EPSG:4326"):(0,f.calculateDistance)(p,e.measurement.lengthFormula),e.uom,l,e.measurement.trueBearing),Polygon:()=>this.formatAreaValue(this.getArea(d),e.uom)},_=this.reprojectedCoordinatesFrom4326(p);if(!l)for(let t=0;t<p.length-1;++t){this.createSegmentLengthOverlay();const o=(0,f.calculateAzimuth)(p[t],p[t+1],"EPSG:4326"),s=(0,f.calculateDistance)([p[t],p[t+1]],e.measurement.lengthFormula),r=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,v.rp)(o,this.props.measurement.trueBearing)||"",i=this.formatLengthValue(s,e.uom,l)+r;y()(this.segmentOverlayElements).innerHTML=i;let a=(0,f.midpoint)(p[t],p[t+1],!0),h=(0,f.midpoint)(_[t],_[t+1],!0);if("LineString"===n){const e=c[100*t+50];e&&(a=e,h=(0,f.pointObjectToArray)((0,f.reproject)(e,"EPSG:4326",N(this.props.map))))}y()(this.segmentOverlays).setPosition(h),this.textLabels[this.segmentOverlays.length-1]={text:i,position:a},this.segmentLengths[this.segmentOverlays.length-1]={value:s,type:l?"bearing":"length"}}if(this.createMeasureTooltip(),"Polygon"===n&&this.createMeasureTooltip(),this.tooltipCoord="LineString"===n?y()(_):this.tooltipCoord=d.getInteriorPoint().getCoordinates(),y()(this.measureTooltipElements).innerHTML=g[n](),y()(this.measureTooltips).setPosition(this.tooltipCoord),this.outputValues[this.measureTooltipElements.length-1]={value:m[n](),type:"Polygon"===n?"area":l?"bearing":"length"},"Polygon"===n){const t=(0,f.calculateDistance)(p,e.measurement.lengthFormula);this.measureTooltipElements[this.measureTooltipElements.length-2].innerHTML=this.formatLengthValue(t,e.uom,!1),this.outputValues[this.measureTooltipElements.length-2]={value:t,type:"length"},this.perimeterTooltipCoord=y()(_),this.measureTooltips[this.measureTooltipElements.length-2].setPosition(this.perimeterTooltipCoord),this.measureTooltips[this.measureTooltipElements.length-2].setOffset([0,-7])}let w={...t};return w.properties=t.properties?{...t.properties}:{},w.properties.values=[{value:(m[n]||(()=>null))(),formattedValue:(g[n]||(()=>null))(),position:"Polygon"===n?(0,f.pointObjectToArray)((0,f.reproject)(d.getInteriorPoint().getCoordinates(),N(e.map),"EPSG:4326")):y()(p),type:(a[0]||{}).type||(e.measurement.pointMeasureEnabled?"point":e.measurement.lineMeasureEnabled?"length":e.measurement.areaMeasureEnabled?"area":e.measurement.bearingMeasureEnabled?"bearing":void 0)},..."Polygon"===n?[{value:(0,f.calculateDistance)(p,e.measurement.lengthFormula),formattedValue:this.formatLengthValue((0,f.calculateDistance)(p,e.measurement.lengthFormula),e.uom,!1),position:y()(p),uom:e.uom,type:"length"}]:[]],[w,d]})),n=i.map((e=>e[0])),a=i.map((e=>e[1]));this.source.addFeatures(a.filter((e=>!!e)).map((e=>new T.Z({geometry:e}))));let l=[...this.textLabels];n.map(((e,t)=>{var o,s;const i=!(null===(o=e.properties)||void 0===o||null===(s=o.values)||void 0===s||!s.find((e=>"bearing"===e.type))),n="Polygon"===e.geometry.type,a=n||i?0:1,p=n?e.geometry.coordinates[0]:e.geometry.coordinates,h=p.some((e=>!(0,v.wd)(e))),c=n?p.length-1:i?0:p.length;return e.geometry.textLabels=null!==r&&r===t&&h?e.geometry.textLabels.concat([{text:"0"}]):l.splice(0,c-a)||[],e})),this.props.changeGeometry(n),this.props.setTextLabels([...this.textLabels]);for(let e=0;e<this.measureTooltipElements.length;++e)this.measureTooltipElements[e]&&(this.measureTooltipElements[e].className="tooltip tooltip-static");for(let e=0;e<this.segmentOverlayElements.length;++e)this.segmentOverlayElements[e]&&(this.segmentOverlayElements[e].className="segment-overlay segment-overlay-static")})),D(this,"updateMeasures",(e=>{const t=t=>{let{type:o,value:s}=t;return"length"===o?this.formatLengthValue(s,e.uom,!1):"area"===o?this.formatAreaValue(s,e.uom):this.formatLengthValue(s,e.uom,!0,e.measurement.trueBearing)};this.outputValues=this.outputValues||[],this.segmentOverlayElements=this.segmentOverlayElements||[],this.textLabels=this.textLabels||[];for(let e=0;e<this.outputValues.length;++e)this.outputValues[e]&&(this.measureTooltipElements[e].innerHTML=t(this.outputValues[e]));for(let e=0;e<this.segmentOverlayElements.length;++e){if(!this.segmentOverlayElements[e])continue;const o=t(this.segmentLengths[e]);let s=this.textLabels[e].text;const r=s.indexOf(" | ");s=s.replace(s.substring(0,-1!==r?r:s.length),o),this.segmentOverlayElements[e].innerHTML=s,this.textLabels[e].text=s}this.drawing||this.props.setTextLabels([...this.textLabels]);const o=(e.measurement.features||[]).map((e=>({...e,...e.properties?{properties:{...e.properties,values:(e.properties.values||[]).map((e=>({...e,formattedValue:t({type:e.type,value:e.value})})))}}:{}})));this.props.changeGeometry(o)})),D(this,"addFeature",(e=>{let t=!1;this.source||(this.source=new P.Z,t=!0);let o=(0,f.reprojectGeoJson)(e,"EPSG:4326",N(this.props.map)).geometry;const s=new T.Z({geometry:(0,x.y7)(o)});this.source.addFeature(s),t&&this.measureLayer.setSource(this.source)})),D(this,"resetGeometry",(()=>{this.source.clear(),this.props.resetGeometry()})),D(this,"saveDrawState",(()=>{var e,t,o,s;this.savedDrawState={textLabels:this.textLabels.slice(),segmentLengths:this.segmentLengths.slice(),measureTooltipsLength:null!==(e=null===(t=this.measureTooltips)||void 0===t?void 0:t.length)&&void 0!==e?e:0,segmentOverlaysLength:null!==(o=null===(s=this.segmentOverlays)||void 0===s?void 0:s.length)&&void 0!==o?o:0}})),D(this,"discardDrawState",(()=>{this.savedDrawState=null})),D(this,"restoreDrawState",(()=>{if(this.savedDrawState){this.textLabels=this.savedDrawState.textLabels,this.segmentLengths=this.savedDrawState.segmentLengths;for(let e=this.savedDrawState.measureTooltipsLength;e<this.measureTooltips.length;++e)this.props.map.removeOverlay(this.measureTooltips[e]),this.measureTooltipElements[e].parentNode.removeChild(this.measureTooltipElements[e]);for(let e=this.savedDrawState.segmentOverlaysLength;e<this.segmentOverlays.length;++e)this.props.map.removeOverlay(this.segmentOverlays[e]),this.segmentOverlayElements[e].parentNode.removeChild(this.segmentOverlayElements[e]);this.measureTooltips.splice(this.savedDrawState.measureTooltipsLength),this.measureTooltipElements.splice(this.savedDrawState.measureTooltipsLength),this.outputValues.splice(this.savedDrawState.measureTooltipsLength),this.segmentOverlays.splice(this.savedDrawState.segmentOverlaysLength),this.segmentOverlayElements.splice(this.savedDrawState.segmentOverlaysLength),this.curPolygonLength=void 0,this.curLineStringLength=void 0,this.savedDrawState=null}})),D(this,"addDrawInteraction",(e=>{let t,o,{startEndPoint:s}=e.measurement;if(this.continueLineMsg=(0,b.S$)(this.context.messages,"measureSupport.continueLine"),this.continuePolygonMsg=(0,b.S$)(this.context.messages,"measureSupport.continuePolygon"),this.drawInteraction&&this.removeDrawInteraction(),!this.vector){this.source=new P.Z;let t=[new O.default({fill:new F.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new G.default({color:"#ffcc33",width:2}),image:new M.default({radius:7,fill:new F.default({color:"#ffcc33"})})})],o=[],r=s||!0===s;if(r||void 0===s){let t=r?void 0===s?{}:s:e.startEndPoint;o=(0,w.rm)(t.startPointOptions,t.endPointOptions)}const i=[...t,...o];this.vector=new S.Z({source:this.source,zIndex:1e6,style:i}),this.props.map.addLayer(this.vector)}o="Bearing"===e.measurement.geomType?"LineString":e.measurement.geomType,t=new I.ZP({source:new P.Z,type:o,style:new O.default({fill:new F.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new G.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new M.default({radius:5,stroke:new G.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new F.default({color:"rgba(255, 255, 255, 0.2)"})})})}),this.clickListener=this.props.map.on("click",(()=>this.updateMeasurementResults(this.props))),this.props.updateOnMouseMove&&this.props.map.on("pointermove",(()=>this.updateMeasurementResults(this.props))),this.props.map.on("pointermove",(e=>this.pointerMoveHandler(e))),t.on("drawstart",(e=>{var t,o;this.sketchFeature=e.feature,this.drawing=!0,this.textId=(null===(t=this.props.measurement)||void 0===t||null===(o=t.features)||void 0===o?void 0:o.length)||0,this.textLabels||(this.textLabels=[]),this.segmentLengths||(this.segmentLengths=[]),this.props.measurement.disableLabels||(this.saveDrawState(),this.createMeasureTooltip("Polygon"===this.props.measurement.geomType?[0,0]:void 0),"Polygon"===this.props.measurement.geomType&&this.createMeasureTooltip(),"Polygon"===this.props.measurement.geomType&&this.createSegmentLengthOverlay()),this.listener=this.sketchFeature.getGeometry().on("change",(e=>{let t,o,s=e.target;if(s instanceof E.ZP){o={value:this.getArea(s),type:"area"},t=this.formatAreaValue(o.value,this.props.uom),this.tooltipCoord=s.getInteriorPoint().getCoordinates();const e=s.getCoordinates()[0];let r=[];if(!this.props.measurement.disableLabels&&((void 0===this.curPolygonLength||this.curPolygonLength<e.length)&&(this.createSegmentLengthOverlay(),this.curPolygonLength=e.length),e.length>2)){r.push((0,f.midpoint)(e[e.length-1],e[e.length-2],!0)),r.push((0,f.midpoint)(e[e.length-2],e[e.length-3],!0));for(let t=0;t<r.length;++t){const o=e.slice(e.length-2-t,e.length-t),s=this.getLength(o,this.props),i=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,v.rp)((0,f.calculateAzimuth)(o[0],o[1],N(this.props.map)),this.props.measurement.trueBearing)||"",n=this.formatLengthValue(s,this.props.uom,!1)+i;this.segmentOverlayElements[this.segmentOverlays.length-t-1].innerHTML=n,this.segmentOverlays[this.segmentOverlays.length-t-1].setPosition(r[t]),this.segmentLengths[this.segmentOverlays.length-t-1]={value:s,type:"length"},this.textLabels[this.segmentOverlays.length-t-1]={text:n,position:(0,f.pointObjectToArray)((0,f.reproject)(r[t],N(this.props.map),"EPSG:4326")),type:this.props.measurement.geomType,textId:this.textId}}}}else if(s instanceof C.Z){const e=s.getCoordinates(),r=[e[e.length-2],e[e.length-1]];this.props.measurement.disableLabels||this.props.measurement.bearingMeasureEnabled||!(void 0===this.curLineStringLength||this.curLineStringLength<e.length)||(this.createSegmentLengthOverlay(),this.curLineStringLength=e.length);const i=this.getLength(e,this.props),n=this.getLength(r,this.props);if(t=this.formatLengthValue(i,this.props.uom,"Bearing"===this.props.measurement.geomType,this.props.measurement.trueBearing),this.tooltipCoord=s.getLastCoordinate(),!this.props.measurement.disableLabels&&!this.props.measurement.bearingMeasureEnabled){const e=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,v.rp)((0,f.calculateAzimuth)(r[0],r[1],N(this.props.map)),this.props.measurement.trueBearing)||"",t=this.formatLengthValue(n,this.props.uom,"Bearing"===this.props.measurement.geomType,this.props.measurement.trueBearing)+e;y()(this.segmentOverlayElements).innerHTML=t,y()(this.segmentOverlays).setPosition((0,f.midpoint)(r[0],r[1],!0)),this.textLabels[this.segmentOverlays.length-1]={text:t,position:(0,f.pointObjectToArray)((0,f.reproject)((0,f.midpoint)(r[0],r[1],!0),N(this.props.map),"EPSG:4326")),type:this.props.measurement.geomType,textId:this.textId},this.segmentLengths[this.segmentOverlays.length-1]={value:n,type:"Bearing"===this.props.measurement.geomType?"bearing":"length"}}o={value:i,type:"Bearing"===this.props.measurement.geomType?"bearing":"length"}}if(!this.props.measurement.disableLabels&&(y()(this.measureTooltipElements).innerHTML=t,y()(this.measureTooltips).setPosition(this.tooltipCoord),this.outputValues[this.outputValues.length-1]=o,s instanceof E.ZP)){const e=s.getCoordinates()[0],t=this.getLength(3===e.length?m()(e):e,this.props);this.measureTooltipElements[this.measureTooltipElements.length-2].innerHTML=this.formatLengthValue(t,this.props.uom,!1),this.outputValues[this.measureTooltipElements.length-2]={value:t,type:"length"},this.perimeterTooltipCoord=s.getLastCoordinate(),this.measureTooltips[this.measureTooltipElements.length-2].setPosition(this.perimeterTooltipCoord)}}))})),t.on("drawend",(e=>{var t;this.drawing=!1;const o=h()(this.props.measurement,"features",[]),s=e.feature.getGeometry(),r=s.getCoordinates(),i=new k.Z,n={Point:()=>(0,f.reproject)(r,N(this.props.map),"EPSG:4326"),LineString:()=>this.getLength(r,this.props),Polygon:()=>this.getArea(s),Bearing:()=>(0,f.calculateAzimuth)(r[0],r[1],N(this.props.map))},a={LineString:()=>this.formatLengthValue(this.getLength(r,this.props),this.props.uom,!1),Polygon:()=>this.formatAreaValue(this.getArea(s),this.props.uom),Bearing:()=>this.formatLengthValue((0,f.calculateAzimuth)(r[0],r[1],N(this.props.map)),this.props.uom,!0,this.props.measurement.trueBearing)};let l=(0,f.reprojectGeoJson)(i.writeFeatureObject(e.feature.clone()),N(this.props.map),"EPSG:4326");l.properties=l.properties||{},l.properties.values=[{value:(n[this.props.measurement.geomType]||(()=>null))(),formattedValue:(a[this.props.measurement.geomType]||(()=>null))(),position:(0,f.pointObjectToArray)((0,f.reproject)("Polygon"===this.props.measurement.geomType?s.getInteriorPoint().getCoordinates():y()(r),N(this.props.map),"EPSG:4326")),type:this.props.measurement.pointMeasureEnabled?"point":this.props.measurement.lineMeasureEnabled?"length":this.props.measurement.areaMeasureEnabled?"area":this.props.measurement.bearingMeasureEnabled?"bearing":void 0},..."Polygon"===this.props.measurement.geomType?[{value:(this.outputValues[this.measureTooltipElements.length-2]||{}).value||0,formattedValue:this.formatLengthValue((this.outputValues[this.measureTooltipElements.length-2]||{}).value||0,this.props.uom,!1),position:(0,f.pointObjectToArray)((0,f.reproject)(y()(r[0]),N(this.props.map),"EPSG:4326")),uom:this.props.uom,type:"length"}]:[]];let p={...l};if(this.props.measurement.lineMeasureEnabled){let e=p.geometry.coordinates,t=(0,f.transformLineToArcs)(e);if(!this.props.measurement.disableLabels){this.removeLastSegment();for(let o=0;o<e.length-1;++o){const s=t[100*o+50];s&&(this.textLabels[this.segmentOverlays.length-e.length+1+o].position=s,this.segmentOverlays[this.segmentOverlays.length-e.length+1+o].setPosition((0,f.pointObjectToArray)((0,f.reproject)(s,"EPSG:4326",N(this.props.map)))))}}p=(0,_.t8)("geometry.coordinates",t,p)}else!this.props.measurement.disableLabels&&this.props.measurement.areaMeasureEnabled&&(this.textLabels.splice(this.segmentOverlays.length-2,1),this.props.map.removeOverlay(this.segmentOverlays[this.segmentOverlays.length-2]),this.segmentOverlayElements[this.segmentOverlays.length-2].parentNode.removeChild(this.segmentOverlayElements[this.segmentOverlays.length-2]),this.segmentOverlayElements.splice(this.segmentOverlays.length-2,1),this.segmentOverlays.splice(this.segmentOverlays.length-2,1));const c="bearing"===(null===(t=l.properties.values[0])||void 0===t?void 0:t.type)?"Bearing":l.geometry.type;if(l.geometry.textLabels=this.textLabels.filter((e=>e.type===c&&e.textId===this.textId)).map((e=>{let{textId:t,type:o,...s}=e;return s})),this.props.changeGeometry([...o,l]),this.props.setTextLabels([...this.textLabels]),this.addFeature(p),!this.props.measurement.disableLabels&&(y()(this.measureTooltipElements).className="tooltip tooltip-static",y()(this.measureTooltips).setOffset([0,-7]),"Polygon"===this.props.measurement.geomType&&(this.measureTooltipElements[this.measureTooltipElements.length-2].className="tooltip tooltip-static",this.measureTooltips[this.measureTooltipElements.length-2].setOffset([0,-7])),this.segmentOverlayElements))for(let e=0;e<this.segmentOverlayElements.length;++e)this.segmentOverlayElements[e]&&(this.segmentOverlayElements[e].className="segment-overlay segment-overlay-static");(0,Z.B)(this.listener),this.curPolygonLength=void 0,this.curLineStringLength=void 0,this.discardDrawState()})),this.props.map.addInteraction(t),this.createHelpTooltip(),this.drawInteraction=t,this.measureLayer=this.vector})),D(this,"removeLastSegment",(()=>{this.textLabels.pop(),this.segmentLengths.pop(),this.props.map.removeOverlay(y()(this.segmentOverlays)),y()(this.segmentOverlayElements).parentNode.removeChild(y()(this.segmentOverlayElements)),this.segmentOverlays.pop(),this.segmentOverlayElements.pop()})),D(this,"removeDrawInteraction",(()=>{null!==this.drawInteraction&&(this.removeHelpTooltip(),this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,this.sketchFeature=null,this.props.map.un("click",(()=>this.updateMeasurementResults(this.props)),this),(0,Z.B)(this.clickListener),this.props.updateOnMouseMove&&this.props.map.un("pointermove",(()=>this.updateMeasurementResults(this.props)),this))})),D(this,"pointerMoveHandler",(function(e){if(e.dragging)return;let t=(0,b.S$)(this.context.messages,"measureSupport.startDrawing");if(this.sketchFeature&&this.drawing){let e=this.sketchFeature.getGeometry();e instanceof E.ZP?t=this.continuePolygonMsg:e instanceof C.Z&&(t=this.continueLineMsg)}this.helpTooltipElement.innerHTML=t,this.helpTooltip.setPosition(e.coordinate),this.helpTooltipElement.classList.remove("hidden")})),D(this,"updateMeasurementResults",(e=>{if(!this.sketchFeature)return;let t=this.sketchFeature.getGeometry().getCoordinates();if("Bearing"===e.measurement.geomType&&t.length>1&&t.length>2){for(this.drawInteraction.sketchCoords_=[t[0],t[1],t[0]];this.sketchFeature.getGeometry().getCoordinates().length>3;)this.drawInteraction.removeLastPoint();this.sketchFeature.getGeometry().setCoordinates([t[0],t[1]]),this.drawInteraction.sketchFeature_=this.sketchFeature,this.drawInteraction.finishDrawing()}})),D(this,"reprojectedCoordinatesFrom4326",(e=>e.map((e=>{let t=(0,f.reproject)(e,"EPSG:4326",N(this.props.map));return[t.x,t.y]})))),D(this,"reprojectedCoordinatesIn4326",(e=>e.map((e=>{let t=(0,f.reproject)(e,N(this.props.map),"EPSG:4326");return[t.x,t.y]})))),D(this,"calculateGeodesicArea",(e=>{if(e.length>=4){const t=this.reprojectedCoordinatesIn4326(e);return Math.abs((0,j.bg)(new E.ZP([t]),{projection:"EPSG:4326"}))}return 0})),D(this,"createHelpTooltip",(()=>{this.removeHelpTooltip(),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="tooltip hidden",this.helpTooltip=new L.Z({element:this.helpTooltipElement,offset:[15,0],positioning:"center-left"}),this.props.map.addOverlay(this.helpTooltip)})),D(this,"createMeasureTooltip",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,-15];e.measureTooltipElements||(e.measureTooltipElements=[]),e.measureTooltips||(e.measureTooltips=[]),e.outputValues||(e.outputValues=[]);let o=document.createElement("div");o.className="tooltip tooltip-measure",o.style.display=e.props.measurement.showLabel?"":"none",e.measureTooltipElements.push(o);let s=new L.Z({element:o,offset:t,positioning:"bottom-center"});e.props.map.addOverlay(s),e.measureTooltips.push(s),e.outputValues.push(null)})),D(this,"createSegmentLengthOverlay",(e=>{this.segmentOverlayElements||(this.segmentOverlayElements=[]),this.segmentOverlays||(this.segmentOverlays=[]);let t=document.createElement("div");t.className="segment-overlay",t.style.display=this.props.measurement.showSegmentLengths&&!e?"":"none",this.segmentOverlayElements.push(t);let o=new L.Z({element:t,offset:[0,0],positioning:"center-center"});this.props.map.addOverlay(o),this.segmentOverlays.push(o)})),D(this,"formatLengthValue",(function(t,o,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(s)return(0,v.rp)(t,r);const{label:i,unit:n}=o&&o.length,a=l()((0,v.Ov)(t,"m",n),2);return e.props.formatNumber(a)+" "+i})),D(this,"formatAreaValue",((e,t)=>{const{label:o,unit:s}=t&&t.area,r=l()((0,v.Ov)(e,"sqm",s),2);return this.props.formatNumber(r)+" "+o})),D(this,"removeHelpTooltip",(()=>{this.helpTooltipElement&&this.helpTooltipElement.parentNode&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltip&&this.props.map.removeOverlay(this.helpTooltip)})),D(this,"removeMeasureTooltips",(()=>{(this.measureTooltips||[]).forEach((e=>{this.props.map.removeOverlay(e)}));let e=document.getElementsByClassName("tooltip-static")||[];for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);e=document.getElementsByClassName("tooltip-measure")||[];for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);this.measureTooltips=[],this.measureTooltipElements=[],this.outputValues=[]})),D(this,"removeSegmentLengthOverlays",(()=>{(this.segmentOverlays||[]).forEach((e=>{this.props.map.removeOverlay(e)})),(this.segmentOverlayElements||[]).forEach((e=>{e.parentNode.removeChild(e)})),this.segmentOverlays=[],this.segmentOverlayElements=[]}))}UNSAFE_componentWillReceiveProps(e){if(this.measureTooltipElements&&e.measurement.showLabel!==this.props.measurement.showLabel)for(let t=0;t<this.measureTooltipElements.length;++t)this.measureTooltipElements[t]&&(this.measureTooltipElements[t].style.display=e.measurement.showLabel?"":"none");if(this.segmentOverlayElements&&e.measurement.showSegmentLengths)for(let t=0;t<this.segmentOverlayElements.length;++t)this.segmentOverlayElements[t]&&(this.segmentOverlayElements[t].style.display=e.measurement.showSegmentLengths?"":"none");(e.measurement.geomType&&e.measurement.geomType!==this.props.measurement.geomType||e.measurement.geomType&&(e.measurement.lineMeasureEnabled||e.measurement.areaMeasureEnabled||e.measurement.bearingMeasureEnabled)&&!this.props.enabled&&e.enabled)&&(this.restoreDrawState(),this.addDrawInteraction(e)),e.measurement.geomType||(this.removeDrawInteraction(),this.removeMeasureTooltips(),this.removeSegmentLengthOverlays(),this.textLabels=[],this.segmentLengths=[],this.props.map.removeLayer(this.measureLayer),this.vector=null,this.measureLayer=null,e.measurement.features&&e.measurement.features.length>0&&this.props.changeGeometry([]),e.measurement.textLabels&&e.measurement.textLabels.length>0&&this.props.setTextLabels([]),this.source&&(this.source.clear(),this.source=null));let t=this.props.measurement.features,o=e.measurement.features;e.measurement.updatedByUI&&!u()(t,o)?this.updateFeatures(e):e.measurement.updatedByUI&&!u()(this.props.uom,e.uom)&&this.updateMeasures(e)}render(){return null}}D(R,"propTypes",{startEndPoint:n().object,map:n().object,measurement:n().object,enabled:n().bool,uom:n().object,formatNumber:n().func,changeMeasurementState:n().func,updateMeasures:n().func,resetGeometry:n().func,changeGeometry:n().func,updateOnMouseMove:n().bool,setTextLabels:n().func}),D(R,"contextTypes",{messages:n().object}),D(R,"defaultProps",{changeMeasurementState:()=>{},resetGeometry:()=>{},updateMeasures:()=>{},changeGeometry:()=>{},formatNumber:e=>e,setTextLabels:()=>{},startEndPoint:{startPointOptions:{radius:3,fillColor:"green",applyToPolygon:!0},endPointOptions:{radius:3,fillColor:"red",applyToPolygon:!0}},updateOnMouseMove:!1})},28798:(e,t,o)=>{"use strict";o.d(t,{Z:()=>I});var s=o(45697),r=o.n(s),i=o(24852),n=o.n(i),a=o(40392),l=o(27418),p=o.n(l),h=o(97398),c=o.n(h),u=o(78426),d=o(78471),m=o(40188),g=o(39850),y=o(58493),f=o(13910),v=o(93409),_=o(12868),w=o(86340),b=o(19530),x=o(90728),C=o(67644),E=o(85386),L=o(13002),P=o(73381),S=o(21915),T=function(e){function t(t){var o=t||{};e.call(this,{element:document.createElement("div"),render:o.render||O,target:o.target}),this.collapsed_=void 0===o.collapsed||o.collapsed,this.collapsible_=void 0===o.collapsible||o.collapsible,this.collapsible_||(this.collapsed_=!1);var s=void 0!==o.className?o.className:"ol-overviewmap",r=void 0!==o.tipLabel?o.tipLabel:"Overview map",i=void 0!==o.collapseLabel?o.collapseLabel:"";"string"==typeof i?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=i):this.collapseLabel_=i;var n=void 0!==o.label?o.label:"";"string"==typeof n?(this.label_=document.createElement("span"),this.label_.textContent=n):this.label_=n;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),(0,L.oL)(l,P.Z.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new d.default({controls:new u.Z,interactions:new u.Z,view:o.view});var p=this.ovmap_;o.layers&&o.layers.forEach(function(e){p.addLayer(e)}.bind(this));var h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",this.boxOverlay_=new v.Z({position:[0,0],positioning:_.Z.BOTTOM_LEFT,element:h}),this.ovmap_.addOverlay(this.boxOverlay_);var c=s+" "+C.XV+" "+C.hg+(this.collapsed_&&this.collapsible_?" "+C.hN:"")+(this.collapsible_?"":" ol-uncollapsible"),m=this.element;m.className=c,m.appendChild(this.ovmapDiv_),m.appendChild(l);var g=this,y=this.boxOverlay_,f=this.boxOverlay_.getElement(),w=function(e){var t,o={clientX:(t=e).clientX-f.offsetWidth/2,clientY:t.clientY+f.offsetHeight/2},s=p.getEventCoordinate(o);y.setPosition(s)},b=function(e){var t=p.getEventCoordinate(e);g.getMap().getView().setCenter(t),window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",b)};f.addEventListener("mousedown",(function(){window.addEventListener("mousemove",w),window.addEventListener("mouseup",b)}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMap=function(t){var o=this.getMap();if(t!==o){if(o){var s=o.getView();s&&this.unbindView_(s),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,L.oL)(t,f.Z.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(t.getLayerGroup());var r=t.getView();r&&(this.bindView_(r),r.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===g.Z.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var o=this.getMap().getView();this.bindView_(o)}},t.prototype.bindView_=function(e){(0,L.oL)(e,(0,y.v_)(w.Z.ROTATION),this.handleRotationChanged_,this)},t.prototype.unbindView_=function(e){(0,L.Ev)(e,(0,y.v_)(w.Z.ROTATION),this.handleRotationChanged_,this)},t.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),s=e.getView().calculateExtent(o),r=t.getSize(),i=t.getView().calculateExtent(r),n=t.getPixelFromCoordinate((0,S.rL)(s)),a=t.getPixelFromCoordinate((0,S.w$)(s)),l=Math.abs(n[0]-a[0]),p=Math.abs(n[1]-a[1]),h=r[0],c=r[1];l<.1*h||p<.1*c||l>.75*h||p>.75*c?this.resetExtent_():(0,S.r4)(i,s)||this.recenter_()}},t.prototype.resetExtent_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getSize(),s=e.getView().calculateExtent(o),r=t.getView(),i=Math.log(7.5)/Math.LN2,n=1/(.1*Math.pow(2,i/2));(0,S.H9)(s,n),r.fit(s)},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getView();t.getView().setCenter(o.getCenter())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),s=e.getView(),r=t.getView(),i=s.getRotation(),n=this.boxOverlay_,a=this.boxOverlay_.getElement(),l=s.calculateExtent(o),p=r.getResolution(),h=(0,S.hC)(l),c=(0,S.Xv)(l),u=this.calculateCoordinateRotate_(i,h);n.setPosition(u),a&&(a.style.width=Math.abs((h[0]-c[0])/p)+"px",a.style.height=Math.abs((c[1]-h[1])/p)+"px")}},t.prototype.calculateCoordinateRotate_=function(e,t){var o,s=this.getMap().getView().getCenter();return s&&(o=[t[0]-s[0],t[1]-s[1]],(0,x.U1)(o,e),(0,x.IH)(o,s)),o},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(C.hN),this.collapsed_?(0,E.$H)(this.collapseLabel_,this.label_):(0,E.$H)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;this.collapsed_||e.isRendered()||(e.updateSize(),this.resetExtent_(),(0,L.Vx)(e,m.Z.POSTRENDER,(function(e){this.updateBox_()}),this))},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(b.Z);function O(e){this.validateExtent_(),this.updateBox_()}const F=T;function G(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o(55691);const M={className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:"",label:"",collapsed:!0,collapsible:!0};class I extends n().Component{constructor(){super(...arguments),G(this,"dragstart",(e=>{this.dragging||(this.dragBox=this.box.cloneNode(),this.dragBox.setAttribute("class","ol-overview-dargbox"),this.dragBox.style.position="relative",this.box.appendChild(this.dragBox),""===this.box.style.top?this.offsetStartTop=0:this.offsetStartTop=parseInt(this.box.style.top.slice(0,-2),10),""===this.box.style.left?this.offsetStartLeft=0:this.offsetStartLeft=parseInt(this.box.style.left.slice(0,-2),10),this.mouseStartTop=e.pageY,this.mouseStartLeft=e.pageX,this.dragging=!0)})),G(this,"draggingel",(e=>{!0===this.dragging&&(this.dragBox.style.top=this.offsetStartTop+e.pageY-this.mouseStartTop+"px",this.dragBox.style.left=this.offsetStartLeft+e.pageX-this.mouseStartLeft+"px",e.stopPropagation(),e.preventDefault())})),G(this,"dragend",(()=>{if(!0===this.dragging){let e={};e.top=""===this.dragBox.style.top?0:parseInt(this.dragBox.style.top.slice(0,-2),10),e.left=""===this.dragBox.style.left?0:parseInt(this.dragBox.style.left.slice(0,-2),10),this.box.removeChild(this.dragBox),delete this.dragBox,this.dragging=!1,this.setNewExtent(e)}})),G(this,"setNewExtent",(e=>{let t=this.box.offsetWidth,o=this.box.offsetHeight,s=this.props.map.getSize(),r=e.left*Math.abs(s[0]/t),i=e.top*Math.abs(s[1]/o);r=c()(r)?r:0,i=c()(i)?i:0;let n=[0+r,s[1]+i],a=[s[0]+r,0+i],l=this.props.map.getCoordinateFromPixel(n)||[0,0],p=this.props.map.getCoordinateFromPixel(a)||[0,0],h=[l[0],l[1],p[0],p[1]];this.props.map.getView().fit(h,s,{nearest:!0})}))}componentDidMount(){let e=[];this.props.layers.forEach((t=>{e.push(a.default.createLayer(t.type,t.options||{}))}));let t=p()({},M,this.props.overviewOpt,{layers:e});this.overview=new F(t),this.props.map&&this.overview.setMap(this.props.map),this.box=this.overview.element.getElementsByClassName("ol-overviewmap-box").item(0),this.box.onmousedown=e=>{this.dragstart(e),this.box.onmousemove=e=>{this.draggingel(e)},this.overview.element.onmousemove=e=>{this.draggingel(e)},this.box.onmouseup=()=>{this.dragend(),this.overview.element.onmousemove=null,this.box.onmousemove=null,this.box.onmouseup=null}}}render(){return null}}G(I,"displayName","Overview"),G(I,"propTypes",{id:r().string,map:r().object,overviewOpt:r().object,layers:r().array}),G(I,"defaultProps",{id:"overview",overviewOpt:{},layers:[{type:"osm",options:{}}]})},89262:(e,t,o)=>{"use strict";o.d(t,{Z:()=>g});var s=o(24852),r=o.n(s),i=o(80307),n=o.n(i),a=o(45697),l=o.n(a),p=o(93409),h=o(47037),c=o.n(h),u=o(26160),d=o(94492);function m(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class g extends r().Component{constructor(){super(...arguments),m(this,"onPopupClose",(e=>{this.props.onPopupClose(e)})),m(this,"renderPopups",(()=>this.preparePopups().map((e=>{let{popup:t,id:o,component:s,content:i,props:a,containerStyle:l}=e;const p=t.getElement(),h=c()(s)&&d.Z[s]||s;let m;return h?m=r().isValidElement(h)&&h||r().createElement(h,a):i&&(m=u.FP(i)?r().createElement("div",{dangerouslySetInnerHTML:{__html:i}}):i),p&&n().createPortal(r().createElement("div",{className:"map-popup-ol",key:o,onMouseUp:this.convertToClick},r().createElement("div",{className:"ol-popup-content-wrapper"},r().createElement("div",{className:"ol-popup-content",style:l},m)),r().createElement("div",{className:"ol-popup-closer",onClick:()=>this.onPopupClose(o)},"x")),p)})))),m(this,"update",(()=>{(this._popups||[]).map((e=>{let{popup:t}=e;t.setElement(t.getElement())}))})),m(this,"convertToClick",(e=>{const t=new MouseEvent("click",{bubbles:!0});t.stopPropagation=()=>{},e.target.dispatchEvent(t)})),m(this,"preparePopups",(()=>{const{popups:e=[],map:t}=this.props,o=t.getSize();return(this._popups||[]).forEach((e=>{let{popup:o,observer:s}=e;s&&s.disconnect(),o&&t.removeOverlay(o)})),this._popups=e.map((e=>{const s=20,r=Math.round(.9*o[0])-2*s,i=Math.round(.9*o[1])-2*s,{id:n,position:{coordinates:a},className:l,maxWidth:h=r,maxHeight:c=i,autoPan:d=!1,autoPanMargin:m=s,offset:g=[0,0],autoPanAnimation:y={duration:200}}=e,f=h>r?r:h,v=c>i?i:c,_=u.fH(n,l),w=new p.Z({id:n,element:_,autoPan:d,offset:g,autoPanMargin:m,autoPanAnimation:y,positioning:"bottom-center",className:"ol-overlay-container ol-unselectable",position:a});t.addOverlay(w);const b=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=new MutationObserver((()=>{e.getMap().getSize()&&(e.setPosition(void 0),e.setPosition(o.coordinates))}));return s.observe(t,{attributes:!0,childList:!0,subtree:!0}),s}(w,_,{coordinates:a});return{popup:w,observer:b,containerStyle:{maxWidth:f,maxHeight:v},...e}})),this._popups})),m(this,"stopPropagationOnPointerMove",(e=>{e.stopPropagation()}))}UNSAFE_componentWillMount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().addEventListener("pointermove",this.stopPropagationOnPointerMove)}shouldComponentUpdate(e){let{popups:t}=e;return t!==this.props.popups}componentWillUnmount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().removeEventListener("pointermove",this.stopPropagationOnPointerMove)}render(){return r().createElement("div",null,this.renderPopups())}}m(g,"propTypes",{map:l().object,popups:l().arrayOf(l().object),onPopupClose:l().func}),m(g,"defaultProps",{popups:[],onPopupClose:()=>{}})},62536:(e,t,o)=>{"use strict";o.d(t,{Z:()=>E});var s=o(45697),r=o.n(s),i=o(24852),n=o.n(i),a=o(27418),l=o.n(a),p=o(58493),h=o(38906),c=o(19530),u=o(67644),d=o(13002),m=o(18672),g=o(40868),y="units",f="degrees",v="metric",_=[1,2,5],w=function(e){function t(t){var o=t||{},s=void 0!==o.className?o.className:"ol-scale-line";e.call(this,{element:document.createElement("div"),render:o.render||b,target:o.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=s+"-inner",this.element.className=s+" "+u.XV,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==o.minWidth?o.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",(0,d.oL)(this,(0,p.v_)(y),this.handleUnitsChanged_,this),this.setUnits(o.units||v)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getUnits=function(){return this.get(y)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set(y,e)},t.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,o=e.projection,s=this.getUnits(),r=s==f?g.default.DEGREES:g.default.METERS,i=(0,m._Q)(o,e.resolution,t,r);o.getUnits()!=g.default.DEGREES&&o.getMetersPerUnit()&&r==g.default.METERS&&(i*=o.getMetersPerUnit());var n=this.minWidth_*i,a="";if(s==f){var l=g.METERS_PER_UNIT[g.default.DEGREES];o.getUnits()==g.default.DEGREES?n*=l:i/=l,n<l/60?(a="",i*=3600):n<l?(a="",i*=60):a=""}else"imperial"==s?n<.9144?(a="in",i/=.0254):n<1609.344?(a="ft",i/=.3048):(a="mi",i/=1609.344):"nautical"==s?(i/=1852,a="nm"):s==v?n<.001?(a="m",i*=1e6):n<1?(a="mm",i*=1e3):n<1e3?a="m":(a="km",i/=1e3):"us"==s?n<.9144?(a="in",i*=39.37):n<1609.344?(a="ft",i/=.30480061):(a="mi",i/=1609.3472):(0,h.h)(!1,33);for(var p,c,u=3*Math.floor(Math.log(this.minWidth_*i)/Math.log(10));;){if(p=_[(u%3+3)%3]*Math.pow(10,Math.floor(u/3)),c=Math.round(p/i),isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(c>=this.minWidth_)break;++u}var d=p+" "+a;this.renderedHTML_!=d&&(this.innerElement_.innerHTML=d,this.renderedHTML_=d),this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t}(c.Z);function b(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}const x=w;function C(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class E extends n().Component{componentDidMount(){this.scalebar=new x(l()({},this.props,this.props.container?{target:document.querySelector(this.props.container)}:{})),this.props.map&&this.props.map.addControl(this.scalebar)}componentWillUnmount(){if(this.props.container&&document.querySelector(".ol-scale-line"))try{document.querySelector(this.props.container).removeChild(document.querySelector(".ol-scale-line"))}catch(e){}}render(){return null}}C(E,"propTypes",{map:r().object,className:r().string,minWidth:r().number,units:r().oneOf(["degrees","imperial","nautical","metric","us"]),container:r().string}),C(E,"defaultProps",{map:null,className:"ol-scale-line",minWidth:64,units:"metric"})},26160:(e,t,o)=>{"use strict";o.d(t,{fH:()=>i,FP:()=>n,R3:()=>a});var s=o(55877),r=o.n(s);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r()(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms-map-popup";const o=document.createElement("div");return o.setAttribute("id",e+"-map-popup"),o.setAttribute("class",t),o},n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.startsWith("<")},a=(e,t)=>{if(!t)return e;if(t instanceof Node){const o=document.createDocumentFragment();o.appendChild(t),e.appendChild(o)}else n(t)?e.innerHTML=t:e.append(document.createTextNode(String(t)));return e}},80543:(e,t,o)=>{"use strict";o.d(t,{a:()=>p});var s=o(1469),r=o.n(s),i=o(10312),n=o(21915),a=o(69669);const l=(e,t,o,s)=>{if(r()(t)&&r()(t[0])&&r()(t[0][0])){const r=(0,i.reproject)(t[0][0],s,o);return Math.sqrt(Math.pow(e[0]-r.x,2)+Math.pow(e[1]-r.y,2))}return 100},p=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.getGeometry()||"Polygon"!==e.getGeometry().getType()||e.getProperties().center&&0===e.getProperties().center.length)return e;if(e.getProperties()&&e.getProperties().isCircle&&e.getProperties().center&&e.getProperties().center[0]&&e.getProperties().center[1]){const s=e.getGeometry().getExtent();let r;e.getProperties().center?(r=(0,i.reproject)(e.getProperties().center,"EPSG:4326",t),r=[r.x,r.y]):r=(0,n.qg)(s);const p=e.getProperties().crs===t?e.getProperties().radius:l(r,e.getGeometry().getCoordinates(),t,o);return e.setGeometry(new a.Z(r,p)),e}return e}},14976:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var s=o(23645),r=o.n(s)()((function(e){return e[1]}));r.push([e.id,".static-map .ol-control button:hover, .static-map .ol-control button:focus {\r\n    background-color: #f4f4f4;\r\n}\r\n.static-map .ol-zoom .ol-zoom-out, .static-map .ol-zoom .ol-zoom-in{\r\n    width: 26px;\r\n    height: 26px;\r\n    line-height: 26px;\r\n    display: block;\r\n\r\n    color: black;\r\n    background-color: #fff;\r\n    border-width: 0;\r\n    margin:0;\r\n}\r\n.static-map .ol-zoom.ol-unselectable.ol-control .ol-zoom-in, .static-map .ol-zoom.ol-unselectable.ol-control .ol-zoom-out {\r\n    font-family: 'Lucida Console', Monaco, monospace;\r\n    text-align: center;\r\n    text-decoration: none;\r\n    font-weight: bold;\r\n}\r\n\r\n.static-map .ol-zoom .ol-zoom-out{\r\n    font-size: 18px;\r\n    border-radius: 0 0 4px 4px;\r\n}\r\n.static-map .ol-zoom .ol-zoom-in{\r\n    border-bottom: 1px solid #ccc;\r\n    border-radius: 4px 4px 0 0;\r\n    font-size: 20px;\r\n}\r\n.static-map .ol-zoom.ol-unselectable.ol-control{\r\n    top:10px;\r\n    left:10px;\r\n    padding:0;\r\n    box-shadow: rgba(0, 0, 0, 0.65098) 0px 1px 5px 0px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.static-map .ol-scale-line.ol-unselectable{\r\n    background-color: rgba(255, 255, 255, 0.8);\r\n}\r\n",""]);const i=r},57641:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var s=o(23645),r=o.n(s)()((function(e){return e[1]}));r.push([e.id,".static-map .ol-custom-overviewmap,\r\n       .static-map .ol-custom-overviewmap.ol-uncollapsible {\r\n          bottom: 20px;\r\n          left: auto;\r\n          right: 10px;\r\n          top: auto;\r\n\r\n      }\r\n      .static-map .ol-custom-overviewmap:not(.ol-collapsed)  {\r\n\r\n           box-shadow: 0 1px 5px rgba(0,0,0,0.65);\r\n           border-radius: 1px;\r\n           transition: all .2s;\r\n      }\r\n      .static-map .ol-custom-overviewmap .ol-overviewmap-map {\r\n          border: none;\r\n          width: 300px;\r\n          height: 150px;\r\n\r\n      }\r\n\r\n      .static-map .ol-custom-overviewmap .ol-overviewmap-box {\r\n          border: 1px solid black;\r\n          cursor: pointer;\r\n          border-radius: 5px;\r\n      }\r\n\r\n      .static-map .ol-custom-overviewmap:not(.ol-collapsed) button{\r\n          bottom: auto;\r\n          left: auto;\r\n          right: 2px;\r\n          bottom: 2px;\r\n      }\r\n\r\n      .static-map .ol-rotate {\r\n          top: 170px;\r\n          right: 0;\r\n      }\r\n      .static-map .ol-overview-dargbox{\r\n           border: 1px solid black;\r\n           background-color: rgba(125,125,0,.5);\r\n           border-radius: 5px;\r\n      }\r\n",""]);const i=r},91133:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var s=o(23645),r=o.n(s)()((function(e){return e[1]}));r.push([e.id,'.static-map .ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 2px solid blue;\n}\n\n.static-map .ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.static-map .ol-scale-line {\n  background: rgba(0,60,136,0.3);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n.static-map .ol-scale-line-inner {\n  border: 1px solid #eee;\n  border-top: none;\n  color: #eee;\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n}\n.static-map .ol-overlay-container {\n  will-change: left,right,top,bottom;\n}\n\n.static-map .ol-unsupported {\n  display: none;\n}\n.static-map .ol-viewport, .static-map .ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n}\n.static-map .ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n.static-map .ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n.static-map .ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n.static-map .ol-control {\n  position: absolute;\n  background-color: rgba(255,255,255,0.4);\n  border-radius: 4px;\n  padding: 2px;\n}\n.static-map .ol-control:hover {\n  background-color: rgba(255,255,255,0.6);\n}\n.static-map .ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n.static-map .ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n.static-map .ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n.static-map .ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n.static-map .ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n@media print {\n  .static-map .ol-control {\n    display: none;\n  }\n}\n\n.static-map .ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: white;\n  font-size: 1.14em;\n  font-weight: bold;\n  text-decoration: none;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: rgba(0,60,136,0.5);\n  border: none;\n  border-radius: 2px;\n}\n.static-map .ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n.static-map .ol-zoom-extent button {\n  line-height: 1.4em;\n}\n.static-map .ol-compass {\n  display: block;\n  font-weight: normal;\n  font-size: 1.2em;\n  will-change: transform;\n}\n.static-map .ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n.static-map .ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n.static-map .ol-control button:hover,\n.static-map .ol-control button:focus {\n  text-decoration: none;\n  background-color: rgba(0,60,136,0.7);\n}\n.static-map .ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n.static-map .ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n\n.static-map .ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n}\n\n.static-map .ol-attribution ul {\n  margin: 0;\n  padding: 0 .5em;\n  font-size: .7rem;\n  line-height: 1.375em;\n  color: #000;\n  text-shadow: 0 0 2px #fff;\n}\n.static-map .ol-attribution li {\n  display: inline;\n  list-style: none;\n  line-height: inherit;\n}\n.static-map .ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n.static-map .ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n.static-map .ol-attribution ul, .static-map .ol-attribution button {\n  display: inline-block;\n}\n.static-map .ol-attribution.ol-collapsed ul {\n  display: none;\n}\n.static-map .ol-attribution:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.static-map .ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n  height: 1.1em;\n  line-height: 1em;\n}\n.static-map .ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n.static-map .ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.static-map .ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n.static-map .ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.static-map .ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.static-map .ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n.static-map .ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n.static-map .ol-overviewmap .ol-overviewmap-map,\n.static-map .ol-overviewmap button {\n  display: inline-block;\n}\n.static-map .ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid #7b98bc;\n  height: 150px;\n  margin: 2px;\n  width: 150px;\n}\n.static-map .ol-overviewmap:not(.ol-collapsed) button{\n  bottom: 1px;\n  left: 2px;\n  position: absolute;\n}\n.static-map .ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.static-map .ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n.static-map .ol-overviewmap:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.static-map .ol-overviewmap-box {\n  border: 2px dotted rgba(0,60,136,0.7);\n}\n\n.static-map .ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const i=r},57043:(e,t,o)=>{var s=o(62488),r=o(21078),i=o(278),n=o(1469);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),o=arguments[0],a=e;a--;)t[a-1]=arguments[a];return s(n(o)?i(o):[o],r(t,1))}},97398:(e,t,o)=>{var s=o(55639).isFinite;e.exports=function(e){return"number"==typeof e&&s(e)}},72445:(e,t,o)=>{"use strict";o.d(t,{ZP:()=>I});var s=o(73381),r=o(23068),i=o(30006),n=o(86968),a=o(58493),l=o(90728),p=o(13002),h=o(9520),c=o(36403),u=o(64011),d=o(69669),m=o(28795),g=o(44538),y=o(25642),f=o(52329),v=o(13987),_=o(14303),w=o(52043),b=o(40353),x=o(38024),C=o(73604),E=o(29902),L=o(97016),P=o(31219),S="Point",T="LineString",O="Polygon",F="Circle",G="drawstart",M=function(e){function t(t,o){e.call(this,t),this.feature=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(h.ZP);const I=function(e){function t(t){var o=t;o.stopDown||(o.stopDown=u.Dv),e.call(this,o),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(e){var t;return e===m.Z.POINT||e===m.Z.MULTI_POINT?t=S:e===m.Z.LINE_STRING||e===m.Z.MULTI_LINE_STRING?t=T:e===m.Z.POLYGON||e===m.Z.MULTI_POLYGON?t=O:e===m.Z.CIRCLE&&(t=F),t}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_===O?3:2,this.maxPoints_=t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:u.uX;var s,r=t.geometryFunction;if(!r)if(this.type_===m.Z.CIRCLE)r=function(e,t){var o=t||new d.Z([NaN,NaN]),s=(0,l.bI)(e[0],e[1]);return o.setCenterAndRadius(e[0],Math.sqrt(s)),o};else{var i,n=this.mode_;n===S?i=w.Z:n===T?i=g.Z:n===O&&(i=b.ZP),r=function(e,t){var o=t;return o?n===O?e[0].length?o.setCoordinates([e[0].concat([e[0][0]])]):o.setCoordinates([]):o.setCoordinates(e):o=new i(e),o}}this.geometryFunction_=r,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new E.Z({source:new L.Z({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(s=(0,P.createEditingStyle)(),function(e,t){return s[e.getGeometry().getType()]}),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:c.rM,this.freehandCondition_,t.freehand?this.freehandCondition_=c.Bx:this.freehandCondition_=t.freehandCondition?t.freehandCondition:c.vY,(0,p.oL)(this,(0,a.v_)(C.Z.ACTIVE),this.updateState_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===s.Z.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==S&&this.freehandCondition_(t);var o=t.type===i.Z.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&t.type===i.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,o=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===i.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),r=!1):this.freehand_&&t.type===i.Z.POINTERDOWN?r=!1:o?(r=t.type===i.Z.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(t):(t.pointerEvent.pointerType==_.T2||t.type===i.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===i.Z.DBLCLICK&&(r=!1),e.prototype.handleEvent.call(this,t)&&r},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):!!this.condition_(e)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new n.Z(i.Z.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0)},t.prototype.handleUpEvent=function(e){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var o=this.mode_===F;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||o?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e):(this.startDrawing_(e),this.mode_===S&&this.finishDrawing()),t=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!t&&this.stopClick_&&e.stopPropagation(),t},t.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,o=e.pixel,s=t[0]-o[0],r=t[1]-o[1],i=s*s+r*r;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e),!0},t.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var o=!1,s=[this.finishCoordinate_];if(this.mode_===T)o=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===O){var r=this.sketchCoords_;o=r[0].length>this.minPoints_,s=[r[0][0],r[0][r[0].length-2]]}if(o)for(var i=e.map,n=0,a=s.length;n<a;n++){var l=s[n],p=i.getPixelFromCoordinate(l),h=e.pixel,c=h[0]-p[0],u=h[1]-p[1],d=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(c*c+u*u)<=d){this.finishCoordinate_=l;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new r.Z(new w.Z(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(e){var t=e.coordinate;this.finishCoordinate_=t,this.mode_===S?this.sketchCoords_=t.slice():this.mode_===O?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new r.Z(new g.Z(this.sketchLineCoords_)));var o=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new r.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(o),this.updateSketchFeatures_(),this.dispatchEvent(new M(G,this.sketchFeature_))},t.prototype.modifyDrawing_=function(e){var t,o,s,i=e.coordinate,n=this.sketchFeature_.getGeometry();if(this.mode_===S?o=this.sketchCoords_:this.mode_===O?(o=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(e)&&(i=this.finishCoordinate_.slice())):o=(t=this.sketchCoords_)[t.length-1],o[0]=i[0],o[1]=i[1],this.geometryFunction_(this.sketchCoords_,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(i),n.getType()==m.Z.POLYGON&&this.mode_!==O){this.sketchLine_||(this.sketchLine_=new r.Z);var a=n.getLinearRing(0);(s=this.sketchLine_.getGeometry())?(s.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),s.changed()):(s=new g.Z(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(s))}else this.sketchLineCoords_&&(s=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(e){var t,o,s=e.coordinate,r=this.sketchFeature_.getGeometry();this.mode_===T?(this.finishCoordinate_=s.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0),o.push(s.slice()),this.geometryFunction_(o,r)):this.mode_===O&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0),o.push(s.slice()),t&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,r)),this.updateSketchFeatures_(),t&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t=this.sketchFeature_.getGeometry();this.mode_===T?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===O&&((e=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,o=e.getGeometry();this.mode_===T?(t.pop(),this.geometryFunction_(t,o)):this.mode_===O&&(t[0].pop(),this.geometryFunction_(t,o),t=o.getCoordinates()),this.type_===m.Z.MULTI_POINT?e.setGeometry(new f.Z([t])):this.type_===m.Z.MULTI_LINE_STRING?e.setGeometry(new y.Z([t])):this.type_===m.Z.MULTI_POLYGON&&e.setGeometry(new v.Z([t])),this.dispatchEvent(new M("drawend",e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return e&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),e},t.prototype.extend=function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var o=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=o.slice(),this.sketchCoords_.push(o.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new M(G,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},t.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing_(),this.overlay_.setMap(t?e:null)},t}(x.Z)},51273:(e,t,o)=>{"use strict";o.d(t,{Z:()=>v});var s=o(49179),r=o(19629),i=o(79682),n=o(13002),a=o(9520),l=o(36403),p=o(64011),h=o(28795),c=o(47588),u=o(29902),d=o(13580),m=o(97016),g=o(31219),y=function(e){function t(t,o,s,r){e.call(this,t),this.selected=o,this.deselected=s,this.mapBrowserEvent=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(a.ZP);function f(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),o=this.removeCondition_(e),s=this.toggleCondition_(e),r=!t&&!o&&!s,n=e.map,a=this.getFeatures(),p=[],h=[];if(r){(0,d.ZH)(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return h.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var c=a.getLength()-1;c>=0;--c){var u=a.item(c),m=h.indexOf(u);m>-1?h.splice(m,1):(a.remove(u),p.push(u))}0!==h.length&&a.extend(h)}else{n.forEachFeatureAtPixel(e.pixel,function(e,r){if(this.filter_(e,r))return!t&&!s||(0,i.q9)(a.getArray(),e)?(o||s)&&(0,i.q9)(a.getArray(),e)&&(p.push(e),this.removeFeatureLayerAssociation_(e)):(h.push(e),this.addFeatureLayerAssociation_(e,r)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var g=p.length-1;g>=0;--g)a.remove(p[g]);a.extend(h)}return(h.length>0||p.length>0)&&this.dispatchEvent(new y("select",h,p,e)),(0,l.MJ)(e)}const v=function(e){function t(t){e.call(this,{handleEvent:f});var o=t||{};this.condition_=o.condition?o.condition:l.Kf,this.addCondition_=o.addCondition?o.addCondition:l.Fi,this.removeCondition_=o.removeCondition?o.removeCondition:l.Fi,this.toggleCondition_=o.toggleCondition?o.toggleCondition:l.vY,this.multi_=!!o.multi&&o.multi,this.filter_=o.filter?o.filter:p.uX,this.hitTolerance_=o.hitTolerance?o.hitTolerance:0;var s,a,c=new u.Z({source:new m.Z({useSpatialIndex:!1,features:o.features,wrapX:o.wrapX}),style:o.style?o.style:(a=(0,g.createEditingStyle)(),(0,i.l7)(a[h.Z.POLYGON],a[h.Z.LINE_STRING]),(0,i.l7)(a[h.Z.GEOMETRY_COLLECTION],a[h.Z.LINE_STRING]),function(e,t){return e.getGeometry()?a[e.getGeometry().getType()]:null}),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=c,o.layers)if("function"==typeof o.layers)s=o.layers;else{var d=o.layers;s=function(e){return(0,i.q9)(d,e)}}else s=p.uX;this.layerFilter_=s,this.featureLayerAssociation_={};var y=this.getFeatures();(0,n.oL)(y,r.Z.ADD,this.addFeature_,this),(0,n.oL)(y,r.Z.REMOVE,this.removeFeature_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[(0,s.sq)(e)]=t},t.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[(0,s.sq)(e)]},t.prototype.getOverlay=function(){return this.featureOverlay_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var o=this.getMap(),s=this.getFeatures();o&&s.forEach(o.unskipFeature.bind(o)),e.prototype.setMap.call(this,t),this.featureOverlay_.setMap(t),t&&s.forEach(t.skipFeature.bind(t))},t.prototype.addFeature_=function(e){var t=this.getMap();t&&t.skipFeature(e.element)},t.prototype.removeFeature_=function(e){var t=this.getMap();t&&t.unskipFeature(e.element)},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[(0,s.sq)(e)]},t}(c.ZP)},55691:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>n});var s=o(93379),r=o.n(s),i=o(57641);r()(i.Z,{insert:"head",singleton:!1});const n=i.Z.locals||{}}}]);